import{j as e}from"./ui-BFkRrjhf.js";import{i as s,r,h as a}from"./vendor-ClsjX3Mm.js";import{u as t}from"./forms-D4rj3dEP.js";import{t as l,s as o,a as i}from"./validations-f3Vz4Ei2.js";import{u as d,a as n,B as m,s as c,b as x,r as h}from"./index-CgruMJ9X.js";import{I as p}from"./input-K7STGv4F.js";import{L as u}from"./label-D_0g-RlU.js";import{C as g}from"./card-COhXL4y3.js";import{S as f,a as j,b as v,c as N,d as b}from"./select-BhEU0EIQ.js";import{D as y,a as w,b as S,c as k,d as C,e as F}from"./dialog-CHNrEUkw.js";import{B as P}from"./icons-Udnp6KR8.js";import"./charts-DeubIqjP.js";const L=()=>{const[L]=s(),A=L.get("type")||"student",E=L.get("ref")||void 0,T=L.get("mode"),[V,B]=r.useState("login"===T),[G,I]=r.useState(!1),[O,R]=r.useState(!1),[U,D]=r.useState(""),[J,M]=r.useState(!1),W=a(),{toast:q}=d(),{refreshUser:z}=n(),H=t({resolver:l(o),defaultValues:{email:"",password:""}}),Q=t({resolver:l(i),defaultValues:{fullName:"",email:"",password:"",confirmPassword:"",userType:"student",grade:"",age:"",schoolName:"",referralCode:E||""}});return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 dark:from-background dark:via-muted dark:to-background flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-10 left-10 text-5xl animate-bounce delay-200",children:"ðŸŒŸ"}),e.jsx("div",{className:"absolute top-20 right-20 text-5xl animate-bounce delay-500",children:"ðŸŽˆ"}),e.jsx("div",{className:"absolute bottom-20 left-20 text-5xl animate-bounce delay-700",children:"ðŸŽ¨"}),e.jsx("div",{className:"absolute bottom-32 right-32 text-5xl animate-bounce delay-1000",children:"ðŸš€"})]}),e.jsxs(g,{className:"w-full max-w-md p-8 bg-white/95 dark:bg-card shadow-2xl border-4 border-purple-300 relative z-10",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx("div",{className:"p-4 rounded-3xl bg-gradient-to-r from-pink-500 via-purple-500 to-blue-500 mb-4 animate-pulse",children:e.jsx(P,{className:"w-12 h-12 text-white"})}),e.jsx("h1",{className:"text-4xl font-black bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Mindsta"}),e.jsx("p",{className:"text-muted-foreground mt-2 font-bold text-lg",children:V?"Welcome Back! ":"Join the Fun! "}),!V&&e.jsxs("p",{className:"text-sm text-purple-600 dark:text-purple-400 font-semibold mt-1",children:["Sign up as a ","student"===A?"Student ":"parent"===A?"Parent ðŸ‘¨â€ðŸ‘©â€ðŸ‘§":"Educator ðŸ‘¨â€ðŸ«"]})]}),e.jsxs("form",{onSubmit:V?H.handleSubmit(async e=>{var s,r;try{I(!0);const s=await c({email:e.email,password:e.password});if("student"!==s.userType)return q({title:"Access Denied",description:"admin"===s.userType?"Admin accounts must use the admin portal. Redirecting...":"Only students can log in here. Please use the correct portal.",variant:"destructive"}),void setTimeout(()=>{"admin"===s.userType?W("/admin-auth"):"referral"===s.userType&&W("/referral-auth?mode=login")},2e3);q({title:"Welcome back!",description:"Logged in successfully."}),z(),W("/dashboard")}catch(a){(null==(s=a.message)?void 0:s.includes("admin portal"))||(null==(r=a.message)?void 0:r.includes("Admin accounts"))?(q({title:"Admin Access Blocked",description:"Please use the admin portal to log in.",variant:"destructive"}),setTimeout(()=>{W("/admin-auth")},2e3)):q({title:"Login Failed",description:a.message||"Invalid email or password. Please try again.",variant:"destructive"})}finally{I(!1)}}):Q.handleSubmit(async e=>{try{I(!0);await x({email:e.email,password:e.password,fullName:e.fullName,userType:A,grade:e.grade,age:parseInt(e.age||"0"),schoolName:e.schoolName,referralCode:e.referralCode});q({title:"ðŸŽ‰ Account created!",description:"Please log in to continue."}),W(`/auth?mode=login&type=${A}`)}catch(s){q({title:"Signup Failed",description:s.message||"An error occurred during signup. Please try again.",variant:"destructive"})}finally{I(!1)}}),className:"space-y-4",children:[!V&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"fullName",children:"Full Name"}),e.jsx(p,{id:"fullName",type:"text",...Q.register("fullName"),maxLength:100}),Q.formState.errors.fullName&&e.jsx("p",{className:"text-sm text-red-500",children:Q.formState.errors.fullName.message})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"grade",children:"Grade"}),e.jsxs(f,{value:Q.watch("grade"),onValueChange:e=>Q.setValue("grade",e),children:[e.jsx(j,{id:"grade",children:e.jsx(v,{placeholder:"Select"})}),e.jsxs(N,{children:[[1,2,3,4,5,6].map(s=>e.jsxs(b,{value:s.toString(),children:["Grade ",s]},s)),e.jsx(b,{value:"Common Entrance",children:"Common Entrance"})]})]}),Q.formState.errors.grade&&e.jsx("p",{className:"text-sm text-red-500",children:Q.formState.errors.grade.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"age",children:"Age"}),e.jsxs(f,{value:Q.watch("age"),onValueChange:e=>Q.setValue("age",e),children:[e.jsx(j,{id:"age",children:e.jsx(v,{placeholder:"Select"})}),e.jsx(N,{children:[5,6,7,8,9,10,11,12,13,14,15].map(s=>e.jsxs(b,{value:s.toString(),children:[s," years"]},s))})]}),Q.formState.errors.age&&e.jsx("p",{className:"text-sm text-red-500",children:Q.formState.errors.age.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"schoolName",children:"Name of School"}),e.jsx(p,{id:"schoolName",type:"text",...Q.register("schoolName"),maxLength:200}),Q.formState.errors.schoolName&&e.jsx("p",{className:"text-sm text-red-500",children:Q.formState.errors.schoolName.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"email",children:"Email"}),e.jsx(p,{id:"email",type:"email",...V?H.register("email"):Q.register("email"),maxLength:255}),V?H.formState.errors.email&&e.jsx("p",{className:"text-sm text-red-500",children:H.formState.errors.email.message}):Q.formState.errors.email&&e.jsx("p",{className:"text-sm text-red-500",children:Q.formState.errors.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"password",children:"Password"}),e.jsx(p,{id:"password",type:"password",...V?H.register("password"):Q.register("password"),maxLength:100}),V?H.formState.errors.password&&e.jsx("p",{className:"text-sm text-red-500",children:H.formState.errors.password.message}):Q.formState.errors.password&&e.jsx("p",{className:"text-sm text-red-500",children:Q.formState.errors.password.message}),!V&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Must be at least 8 characters with uppercase, lowercase, and number"})]}),!V&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx(p,{id:"confirmPassword",type:"password",...Q.register("confirmPassword"),maxLength:100}),Q.formState.errors.confirmPassword&&e.jsx("p",{className:"text-sm text-red-500",children:Q.formState.errors.confirmPassword.message})]}),!V&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(u,{htmlFor:"referralCode",className:"flex items-center gap-2",children:["Referral Code",e.jsx("span",{className:"text-xs text-muted-foreground font-normal",children:"(Optional)"})]}),e.jsx(p,{id:"referralCode",type:"text",placeholder:"Enter referral code if you have one",...Q.register("referralCode"),maxLength:50}),Q.formState.errors.referralCode&&e.jsx("p",{className:"text-sm text-red-500",children:Q.formState.errors.referralCode.message}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Got a friend's referral code? Enter it to give them rewards!"})]}),e.jsx(m,{type:"submit",className:"w-full bg-gradient-to-r from-pink-500 via-purple-500 to-blue-500 hover:from-pink-600 hover:via-purple-600 hover:to-blue-600 text-white font-black text-lg py-6 shadow-lg hover:shadow-xl transition-all hover:scale-105",disabled:G,children:G?"Please wait... ":V?"Let's Go! ":"Start Learning! "})]}),V&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx("button",{onClick:()=>R(!0),className:"text-sm text-purple-600 dark:text-purple-400 hover:underline",children:"Forgot password?"})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:()=>B(!V),className:"text-purple-600 dark:text-purple-400 hover:underline font-bold text-base",children:V?"New here? Join the fun! ":"Already a member? Log in! "})}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("button",{onClick:()=>W("/"),className:"text-muted-foreground hover:text-purple-600 dark:hover:text-purple-400 transition-colors font-semibold flex items-center gap-2 mx-auto",children:"â† Back to Home"})})]}),e.jsx(y,{open:O,onOpenChange:R,children:e.jsxs(w,{children:[e.jsxs(S,{children:[e.jsx(k,{children:"Reset your password"}),e.jsx(C,{children:"Enter your email and we'll send you a reset link."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"forgot-email",children:"Email Address"}),e.jsx(p,{id:"forgot-email",type:"email",value:U,onChange:e=>D(e.target.value)})]}),e.jsx(F,{children:e.jsx(m,{onClick:async()=>{if(U){M(!0);try{await h(U),q({title:"Email sent!",description:"Check your inbox for a password reset link."}),R(!1),D("")}catch(e){q({title:"Failed",description:(null==e?void 0:e.message)||"Unable to send reset email.",variant:"destructive"})}finally{M(!1)}}else q({title:"Email required",description:"Please enter your email.",variant:"destructive"})},disabled:J,children:J?"Sending...":"Send reset link"})})]})})]})};export{L as default};
