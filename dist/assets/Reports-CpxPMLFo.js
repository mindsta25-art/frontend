import{j as e}from"./ui-BFkRrjhf.js";import{r as s}from"./vendor-ClsjX3Mm.js";import{C as a,a as r,b as t,c as i,d as n}from"./card-COhXL4y3.js";import{f as l,u as o,B as c}from"./index-CgruMJ9X.js";import{L as d}from"./label-D_0g-RlU.js";import{S as m,a as h,b as p,c as x,d as j}from"./select-BhEU0EIQ.js";import{B as u}from"./badge-CO1u2g-4.js";import{D as g,a as f,b as y,c as v,d as N}from"./dialog-CHNrEUkw.js";import{S as b}from"./scroll-area-DkFg0wM_.js";import{A as w}from"./AdminLayout-BWmn8TIL.js";import{y as S,g as R,v as C,ad as k,a0 as D,aR as $,aS as T,U as A,B as L,a2 as B,C as O}from"./icons-Udnp6KR8.js";import"./charts-DeubIqjP.js";const z=async(e={})=>{if("csv"===e.format){return(await fetch(`https://api.yourdomain.com/api/reports/student-progress?${new URLSearchParams(e)}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}})).blob()}return l.get("/reports/student-progress",e)},P=async(e={})=>{if("csv"===e.format){return(await fetch(`https://api.yourdomain.com/api/reports/lesson-analytics?${new URLSearchParams(e)}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}})).blob()}return l.get("/reports/lesson-analytics",e)},U=async(e={})=>{if("csv"===e.format){return(await fetch(`https://api.yourdomain.com/api/reports/engagement-summary?${new URLSearchParams(e)}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}})).blob()}return l.get("/reports/engagement-summary",e)},F=async(e={})=>{if("csv"===e.format){return(await fetch(`https://api.yourdomain.com/api/reports/grade-performance?${new URLSearchParams(e)}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}})).blob()}return l.get("/reports/grade-performance",e)},E=async(e={})=>{if("csv"===e.format){return(await fetch(`https://api.yourdomain.com/api/reports/user-activity?${new URLSearchParams(e)}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}})).blob()}return l.get("/reports/user-activity",e)},I=async(e={})=>{if("csv"===e.format){return(await fetch(`https://api.yourdomain.com/api/reports/content-inventory?${new URLSearchParams(e)}`,{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}})).blob()}return l.get("/reports/content-inventory",e)},V=(e,s)=>{const a=window.URL.createObjectURL(e),r=document.createElement("a");r.href=a,r.download=s,document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(a),document.body.removeChild(r)},G=()=>{const{toast:l}=o(),[G,M]=s.useState("month"),[q,J]=s.useState("json"),[Q,W]=s.useState(null),[Y,Z]=s.useState(null),[H,K]=s.useState(!1),X=[{id:"student-progress",title:"Student Progress Report",description:"Detailed progress tracking for all students including completed lessons, quiz scores, and engagement metrics",icon:A,type:"progress",generator:z},{id:"lesson-analytics",title:"Lesson Analytics Report",description:"Comprehensive analysis of lesson performance, completion rates, and student feedback",icon:L,type:"analytics",generator:P},{id:"engagement-summary",title:"Engagement Summary",description:"Overview of user activity, active sessions, time spent, and interaction patterns",icon:R,type:"engagement",generator:U},{id:"grade-performance",title:"Grade Performance Report",description:"Grade-by-grade analysis showing average scores, completion rates, and subject performance",icon:C,type:"performance",generator:F},{id:"user-activity",title:"User Activity Log",description:"Detailed log of user logins, actions performed, and system interactions",icon:S,type:"activity",generator:E},{id:"content-inventory",title:"Content Inventory",description:"Complete list of all lessons, quizzes, and educational materials with metadata",icon:D,type:"inventory",generator:I}],_=async e=>{try{W(e.id);const s={period:G,format:q},a=await e.generator(s);if("csv"===q){V(a,`${e.id}-${G}-${(new Date).toISOString().split("T")[0]}.csv`),l({title:"✅ Report Downloaded",description:`${e.title} has been downloaded as CSV.`})}else Z({...a,reportTitle:e.title}),K(!0),l({title:"✅ Report Generated",description:"Your report has been generated successfully."})}catch(s){l({title:"❌ Error",description:s.message||"Failed to generate report. Please try again.",variant:"destructive"})}finally{W(null)}},ee=async(e,s="json")=>{try{W("quick-report");const a=await U({period:e,format:s});if("csv"===s){V(a,`quick-engagement-${e}-${(new Date).toISOString().split("T")[0]}.csv`),l({title:"✅ Quick Report Downloaded",description:`${e} engagement report downloaded.`})}else Z({...a,reportTitle:`${e.charAt(0).toUpperCase()+e.slice(1)} Engagement Summary`}),K(!0),l({title:"✅ Quick Report Ready",description:`${e.charAt(0).toUpperCase()+e.slice(1)} report generated.`})}catch(a){l({title:"❌ Error",description:"Failed to generate quick report.",variant:"destructive"})}finally{W(null)}},se=[{label:"Today's Activity",period:"today",icon:S},{label:"Weekly Summary",period:"week",icon:R},{label:"Monthly Overview",period:"month",icon:C}];return e.jsxs(w,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Reports & Export"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Generate detailed reports and export data"})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:se.map(s=>{const t=s.icon;return e.jsx(a,{className:"hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>ee(s.period),children:e.jsx(r,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col items-center text-center space-y-2",children:[e.jsx("div",{className:"p-3 rounded-full bg-primary/10",children:e.jsx(t,{className:"w-6 h-6 text-primary"})}),e.jsx("p",{className:"text-sm font-medium",children:s.label}),e.jsxs(c,{variant:"ghost",size:"sm",className:"gap-1",onClick:e=>{e.stopPropagation(),ee(s.period,"csv")},children:[e.jsx(k,{className:"w-3 h-3"}),"CSV"]})]})})},s.label)})}),e.jsxs(a,{children:[e.jsxs(t,{children:[e.jsx(i,{children:"Report Configuration"}),e.jsx(n,{children:"Configure report parameters before generation"})]}),e.jsx(r,{children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"period",children:"Time Period"}),e.jsxs(m,{value:G,onValueChange:M,children:[e.jsx(h,{id:"period",children:e.jsx(p,{placeholder:"Select period"})}),e.jsxs(x,{children:[e.jsx(j,{value:"today",children:"Today"}),e.jsx(j,{value:"week",children:"This Week"}),e.jsx(j,{value:"month",children:"This Month"}),e.jsx(j,{value:"quarter",children:"This Quarter"}),e.jsx(j,{value:"year",children:"This Year"}),e.jsx(j,{value:"custom",children:"Custom Range"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"format",children:"Export Format"}),e.jsxs(m,{value:q,onValueChange:J,children:[e.jsx(h,{id:"format",children:e.jsx(p,{placeholder:"Select format"})}),e.jsxs(x,{children:[e.jsx(j,{value:"pdf",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4"}),"PDF Document"]})}),e.jsx(j,{value:"excel",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4"}),"Excel Spreadsheet"]})}),e.jsx(j,{value:"csv",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4"}),"CSV File"]})}),e.jsx(j,{value:"json",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),"JSON Data"]})})]})]})]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-bold text-foreground",children:"Available Reports"}),e.jsx("div",{className:"grid gap-4",children:X.map(s=>{const r=s.icon,l=Q===s.id;return e.jsx(a,{className:"hover:shadow-md transition-shadow",children:e.jsx(t,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx("div",{className:"p-3 rounded-lg bg-primary/10",children:e.jsx(r,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(i,{className:"text-lg",children:s.title}),e.jsx(n,{className:"mt-2",children:s.description})]})]}),e.jsxs("div",{className:"flex gap-2",children:["json"===q&&e.jsxs(c,{variant:"outline",className:"gap-2",onClick:()=>_(s),disabled:l,children:[e.jsx(B,{className:"w-4 h-4"}),"View"]}),e.jsx(c,{className:"gap-2",onClick:()=>_(s),disabled:l,children:l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"w-4 h-4"}),"csv"===q?"Download":"Generate"]})})]})]})})},s.id)})})]}),e.jsxs(a,{children:[e.jsxs(t,{children:[e.jsx(i,{children:"Recent Reports"}),e.jsx(n,{children:"Previously generated reports available for download"})]}),e.jsx(r,{children:e.jsx("div",{className:"space-y-3",children:[{name:"Student Progress - November 2025",date:"2025-11-10",size:"2.4 MB",format:"PDF"},{name:"Lesson Analytics - October 2025",date:"2025-11-01",size:"1.8 MB",format:"Excel"},{name:"Engagement Summary - Q3 2025",date:"2025-10-15",size:"3.1 MB",format:"PDF"}].map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border border-border hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 rounded bg-primary/10",children:e.jsx(D,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:s.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.date," • ",s.size," • ",s.format]})]})]}),e.jsxs(c,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(k,{className:"w-4 h-4"}),"Download"]})]},a))})})]}),e.jsx(a,{className:"bg-blue-500/10 border-blue-500/20",children:e.jsx(r,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-2 rounded-full bg-blue-500/20",children:e.jsx(O,{className:"w-5 h-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm mb-1",children:"Dynamic Reporting"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All reports are generated in real-time from your database. Select JSON format to view the report data instantly, or choose CSV for downloads."})]})]})})})]}),e.jsx(g,{open:H,onOpenChange:K,children:e.jsxs(f,{className:"max-w-4xl max-h-[80vh]",children:[e.jsxs(y,{children:[e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5"}),(null==Y?void 0:Y.reportTitle)||"Report Data"]}),e.jsxs(N,{children:["Generated: ",(null==Y?void 0:Y.generatedAt)?new Date(Y.generatedAt).toLocaleString():""]})]}),e.jsx(b,{className:"h-[60vh] pr-4",children:Y&&e.jsxs("div",{className:"space-y-6",children:[Y.summary&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5"}),"Summary"]}),e.jsx(a,{children:e.jsx(r,{className:"pt-6",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:Object.entries(Y.summary).map(([s,a])=>e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:s.replace(/([A-Z])/g," $1").trim()}),e.jsxs("p",{className:"text-lg font-bold",children:["number"!=typeof a||s.toLowerCase().includes("rate")||s.toLowerCase().includes("score")?String(a):a.toLocaleString(),(s.toLowerCase().includes("rate")||s.toLowerCase().includes("score"))&&"number"==typeof a?"%":""]})]},s))})})})]}),Y.data&&Array.isArray(Y.data)&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5"}),"Detailed Data (",Y.data.length," records)"]}),e.jsxs(c,{size:"sm",variant:"outline",onClick:()=>{const e=JSON.stringify(Y.data,null,2),s=new Blob([e],{type:"application/json"});V(s,`${Y.type}-data-${(new Date).toISOString().split("T")[0]}.json`),l({title:"✅ Data Downloaded",description:"Report data exported as JSON."})},className:"gap-2",children:[e.jsx(k,{className:"w-4 h-4"}),"Download JSON"]})]}),e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsx(b,{className:"h-[300px]",children:e.jsxs("div",{className:"p-4 bg-muted/30 font-mono text-xs",children:[e.jsx("pre",{children:JSON.stringify(Y.data.slice(0,50),null,2)}),Y.data.length>50&&e.jsxs("p",{className:"text-muted-foreground mt-2",children:["... and ",Y.data.length-50," more records"]})]})})})]}),Y.userTypeBreakdown&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-bold text-lg",children:"User Type Breakdown"}),e.jsx(a,{children:e.jsx(r,{className:"pt-6",children:e.jsx("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(Y.userTypeBreakdown).map(([s,a])=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/30",children:[e.jsx("span",{className:"capitalize",children:s}),e.jsx(u,{children:a})]},s))})})})]}),Y.activityByDay&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-bold text-lg",children:"Activity by Day"}),e.jsx(a,{children:e.jsx(r,{className:"pt-6",children:e.jsx("div",{className:"space-y-2",children:Object.entries(Y.activityByDay).map(([s,a])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:s}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary rounded-full",style:{width:`${Math.min(100,a/Math.max(...Object.values(Y.activityByDay))*100)}%`}})}),e.jsx("span",{className:"text-sm font-mono w-12 text-right",children:a})]})]},s))})})})]})]})})]})})]})};export{G as default};
