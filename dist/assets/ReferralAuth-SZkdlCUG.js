import{j as e}from"./ui-BFkRrjhf.js";import{h as s,i as a,r as l}from"./vendor-ClsjX3Mm.js";import{u as r,a as t,B as o,s as i,b as d,r as n}from"./index-CgruMJ9X.js";import{I as c}from"./input-K7STGv4F.js";import{L as m}from"./label-D_0g-RlU.js";import{C as u,b as h,c as x,d as p,a as f}from"./card-COhXL4y3.js";import{C as b}from"./checkbox-CPao0aTF.js";import{D as g,a as v,b as y,c as j,d as w,e as N}from"./dialog-CHNrEUkw.js";import{m as k}from"./mindsta2-LbsrOUWs.js";import{a3 as C,X as P,c as S,M as F,_ as q,a4 as T,P as A}from"./icons-Udnp6KR8.js";import"./charts-DeubIqjP.js";const R=()=>{const R=s(),{toast:L}=r(),{refreshUser:E}=t(),[I]=a(),D=I.get("ref"),M=I.get("mode"),[B,W]=l.useState("login"===M),[Y,_]=l.useState(!1),[z,H]=l.useState(!1),[J,O]=l.useState(!1),[U,$]=l.useState(""),[Q,V]=l.useState(!1),[G,K]=l.useState(""),[X,Z]=l.useState(""),[ee,se]=l.useState(""),[ae,le]=l.useState(""),[re,te]=l.useState(""),[oe,ie]=l.useState(""),[de,ne]=l.useState(""),[ce,me]=l.useState(""),[ue,he]=l.useState(!1),[xe,pe]=l.useState(!1);return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-yellow-50 via-orange-50 to-pink-50 dark:from-background dark:via-muted dark:to-background relative overflow-hidden",children:[e.jsx("header",{className:"fixed top-0 left-0 right-0 bg-white/80 dark:bg-card backdrop-blur-sm shadow-lg border-b-4 border-yellow-300 z-50",children:e.jsxs("div",{className:"container mx-auto px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-xl bg-gradient-to-r from-yellow-500 via-orange-500 to-pink-500 animate-pulse",children:e.jsx("img",{src:k,alt:"Mindsta Logo",className:"w-6 h-6 object-contain"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-black bg-gradient-to-r from-yellow-600 to-orange-600 bg-clip-text text-transparent",children:"Mindsta Referral"}),e.jsx("span",{className:"text-xs text-muted-foreground font-bold",children:"Refer Friends â€¢ Earn Rewards! "})]})]}),e.jsxs(o,{onClick:()=>R("/"),className:"hidden md:flex gap-2 border-2 border-yellow-300 hover:border-yellow-500 font-bold",children:[e.jsx(C,{className:"w-4 h-4"}),"Back to Home"]}),e.jsx("button",{onClick:()=>H(!z),className:"md:hidden p-2 rounded-lg hover:bg-yellow-100 transition-colors","aria-label":"Toggle menu",children:z?e.jsx(P,{className:"w-6 h-6 text-yellow-600"}):e.jsx(S,{className:"w-6 h-6 text-yellow-600"})})]}),z&&e.jsx("div",{className:"md:hidden mt-4 pb-4 animate-in slide-in-from-top-5 duration-200",children:e.jsxs(o,{onClick:()=>{R("/"),H(!1)},className:"w-full gap-2 border-2 border-yellow-300 hover:border-yellow-500 font-bold justify-center",children:[e.jsx(C,{className:"w-4 h-4"}),"Back to Home"]})})]})}),e.jsx("main",{className:"container mx-auto px-4 py-12 relative z-10 mt-20 flex items-center justify-center min-h-[calc(100vh-160px)]",children:e.jsxs(u,{className:"w-full max-w-md border-4 border-yellow-300 shadow-2xl bg-white dark:bg-card",children:[e.jsxs(h,{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4 animate-bounce"}),e.jsx(x,{className:"text-3xl font-black",children:B?"Welcome Back!":"Join the Referral Program!"}),e.jsx(p,{className:"text-lg font-bold",children:B?"Login to your referral account":"Create your account and start earning rewards!"}),D&&!B&&e.jsx("div",{className:"mt-4 p-3 bg-green-50 border-2 border-green-300 rounded-lg",children:e.jsxs("p",{className:"text-sm font-bold text-green-700",children:["ðŸŽ‰ You're using referral code: ",e.jsx("span",{className:"font-black",children:D})]})})]}),e.jsx(f,{children:B?e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),G&&X){_(!0);try{const e=await i({email:G,password:X});if("referral"!==e.userType)return L({title:"Access Denied",description:"admin"===e.userType?"Admin accounts must use the admin portal. Redirecting...":"Only referral users can log in here. Please use the correct portal.",variant:"destructive"}),void setTimeout(()=>{"admin"===e.userType?R("/admin-auth"):"student"===e.userType&&R("/auth?mode=login&type=student")},2e3);L({title:"Welcome Back! ðŸŽ‰",description:"Successfully logged in!"}),E(),R("/referral")}catch(s){L({title:"Login Failed",description:(null==s?void 0:s.message)||"Invalid email or password. Please try again.",variant:"destructive"})}finally{_(!1)}}else L({title:"Missing Information! âš ï¸",description:"Please fill in all fields.",variant:"destructive"})},className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"login-email",className:"font-bold",children:"Email Address "}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute left-3 top-3 h-5 w-5 text-muted-foreground"}),e.jsx(c,{id:"login-email",type:"email",placeholder:"your@email.com",value:G,onChange:e=>K(e.target.value),className:"pl-10 border-2 border-yellow-200 focus:border-yellow-400",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"login-password",className:"font-bold",children:"Password "}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-3 h-5 w-5 text-muted-foreground"}),e.jsx(c,{id:"login-password",type:"password",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",value:X,onChange:e=>Z(e.target.value),className:"pl-10 border-2 border-yellow-200 focus:border-yellow-400",required:!0})]})]}),e.jsx(o,{type:"submit",disabled:Y,className:"w-full text-lg font-black py-6 bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600",children:Y?"Logging In...":"Login "}),e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"button",onClick:()=>O(!0),className:"text-sm font-bold text-yellow-600 hover:text-yellow-700 underline",children:"Forgot password?"})}),e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"button",onClick:()=>W(!1),className:"text-sm font-bold text-yellow-600 hover:text-yellow-700 underline",children:"Don't have an account? Register here!"})})]}):e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),ee&&ae&&re&&oe&&de&&ce)if(de===ce)if(de.length<6)L({title:"Weak Password! ",description:"Password must be at least 6 characters.",variant:"destructive"});else if(ue)if(xe){_(!0);try{await d({email:re,password:de,fullName:`${ee} ${ae}`,userType:"referral",grade:void 0,age:void 0,schoolName:void 0,referralCode:D||void 0}),L({title:"Account created! ",description:D?"Please log in to start earning rewards with your referral.":"Please log in to continue."}),R("/referral-auth?mode=login")}catch(s){L({title:"Registration Failed",description:(null==s?void 0:s.message)||"An unexpected error occurred. Please try again.",variant:"destructive"})}finally{_(!1)}}else L({title:"Privacy Required! ",description:"You must agree to the Privacy Policy.",variant:"destructive"});else L({title:"Terms Required! ",description:"You must agree to the Terms and Conditions.",variant:"destructive"});else L({title:"Password Mismatch! ",description:"Passwords do not match.",variant:"destructive"});else L({title:"Missing Information! ",description:"Please fill in all fields.",variant:"destructive"})},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"first-name",className:"font-bold",children:"First Name "}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-3 h-5 w-5 text-muted-foreground"}),e.jsx(c,{id:"first-name",type:"text",placeholder:"John",value:ee,onChange:e=>se(e.target.value),className:"pl-10 border-2 border-yellow-200 focus:border-yellow-400",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"last-name",className:"font-bold",children:"Last Name "}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-3 h-5 w-5 text-muted-foreground"}),e.jsx(c,{id:"last-name",type:"text",placeholder:"Doe",value:ae,onChange:e=>le(e.target.value),className:"pl-10 border-2 border-yellow-200 focus:border-yellow-400",required:!0})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"email",className:"font-bold",children:"Email Address "}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute left-3 top-3 h-5 w-5 text-muted-foreground"}),e.jsx(c,{id:"email",type:"email",placeholder:"your@email.com",value:re,onChange:e=>te(e.target.value),className:"pl-10 border-2 border-yellow-200 focus:border-yellow-400",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"phone",className:"font-bold",children:"Phone Number "}),e.jsxs("div",{className:"relative",children:[e.jsx(A,{className:"absolute left-3 top-3 h-5 w-5 text-muted-foreground"}),e.jsx(c,{id:"phone",type:"tel",placeholder:"+1234567890",value:oe,onChange:e=>ie(e.target.value),className:"pl-10 border-2 border-yellow-200 focus:border-yellow-400",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"password",className:"font-bold",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-3 h-5 w-5 text-muted-foreground"}),e.jsx(c,{id:"password",type:"password",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",value:de,onChange:e=>ne(e.target.value),className:"pl-10 border-2 border-yellow-200 focus:border-yellow-400",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"confirm-password",className:"font-bold",children:"Confirm Password "}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-3 h-5 w-5 text-muted-foreground"}),e.jsx(c,{id:"confirm-password",type:"password",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",value:ce,onChange:e=>me(e.target.value),className:"pl-10 border-2 border-yellow-200 focus:border-yellow-400",required:!0})]})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(b,{id:"terms",checked:ue,onCheckedChange:e=>he(e),className:"mt-1"}),e.jsxs("label",{htmlFor:"terms",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:["I agree to the"," ",e.jsx("button",{type:"button",className:"text-yellow-600 hover:text-yellow-700 underline font-bold",onClick:()=>window.open("/terms","_blank"),children:"Terms and Conditions"})]})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(b,{id:"privacy",checked:xe,onCheckedChange:e=>pe(e),className:"mt-1"}),e.jsxs("label",{htmlFor:"privacy",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:["I agree to the"," ",e.jsx("button",{type:"button",className:"text-yellow-600 hover:text-yellow-700 underline font-bold",onClick:()=>window.open("/privacy","_blank"),children:"Privacy Policy"})]})]})]}),e.jsx(o,{type:"submit",disabled:Y,className:"w-full text-lg font-black py-6 bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600",children:Y?"Creating Account...":"Create Account "}),e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"button",onClick:()=>W(!0),className:"text-sm font-bold text-yellow-600 hover:text-yellow-700 underline",children:"Already have an account? Login here!"})})]})})]})}),e.jsx(g,{open:J,onOpenChange:O,children:e.jsxs(v,{children:[e.jsxs(y,{children:[e.jsx(j,{children:"Reset your password"}),e.jsx(w,{children:"Enter your email and we'll send you a reset link."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"forgot-email",children:"Email Address"}),e.jsx(c,{id:"forgot-email",type:"email",value:U,onChange:e=>$(e.target.value)})]}),e.jsx(N,{children:e.jsx(o,{onClick:async()=>{if(U){V(!0);try{await n(U),L({title:"Email sent!",description:"Check your inbox for a password reset link."}),O(!1),$("")}catch(e){L({title:"Failed",description:(null==e?void 0:e.message)||"Unable to send reset email.",variant:"destructive"})}finally{V(!1)}}else L({title:"Email required",description:"Please enter your email.",variant:"destructive"})},disabled:Q,children:Q?"Sending...":"Send reset link"})})]})})]})};export{R as default};
