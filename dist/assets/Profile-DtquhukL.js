import{j as e}from"./ui-BFkRrjhf.js";import{h as s,r as a}from"./vendor-ClsjX3Mm.js";import{a as l,u as r,B as t}from"./index-CgruMJ9X.js";import{S as i,A as n,c,g as d,d as o}from"./StudentHeader-BEY8Ekm7.js";import{I as m}from"./input-K7STGv4F.js";import{L as x}from"./label-D_0g-RlU.js";import{C as h,b as u,c as j,a as p,d as g}from"./card-COhXL4y3.js";import{S as N,a as f,b as v,c as y,d as b}from"./select-BhEU0EIQ.js";import{S}from"./separator-D-EoJ3Ty.js";import{B as w}from"./badge-CO1u2g-4.js";import{a3 as C,h as E,y as F,a4 as k,M as A,a5 as P,a6 as U}from"./icons-Udnp6KR8.js";import"./charts-DeubIqjP.js";import"./scroll-area-DkFg0wM_.js";import"./formatDistanceToNow-Bf1kdoXg.js";import"./lessons-BDW73QPv.js";import"./siteConfig-BOV2ERHg.js";const D=()=>{const{user:D,loading:B}=l(),G=s(),{toast:M}=r(),[I,L]=a.useState(null),[T,$]=a.useState(!0),[q,H]=a.useState(!1),[J,O]=a.useState(""),[Q,R]=a.useState(""),[V,X]=a.useState(""),[_,z]=a.useState("");a.useEffect(()=>{B||D||G("/auth")},[D,B,G]),a.useEffect(()=>{(async()=>{var e;if(D)try{$(!0);const s=await d(D.id);s&&(L(s),O(s.fullName),R((null==(e=s.age)?void 0:e.toString())||""),X(s.grade),z(s.schoolName))}catch(s){M({title:"Error",description:"Failed to load profile",variant:"destructive"})}finally{$(!1)}})()},[D,M]);return T?e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx(i,{studentName:J}),e.jsx("div",{className:"pt-24 container mx-auto px-4",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-gray-200 dark:bg-gray-800 rounded w-1/4"}),e.jsx("div",{className:"h-64 bg-gray-200 dark:bg-gray-800 rounded"})]})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx(i,{studentName:J}),e.jsx("main",{className:"pt-24 pb-16 container mx-auto px-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(t,{variant:"ghost",onClick:()=>G(-1),className:"mb-4 gap-2",children:[e.jsx(C,{className:"w-4 h-4"}),"Back"]}),e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"My Profile"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your personal information"})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsxs(h,{className:"lg:col-span-1",children:[e.jsx(u,{children:e.jsx(j,{children:"Profile"})}),e.jsxs(p,{className:"flex flex-col items-center text-center",children:[e.jsx(n,{className:"w-24 h-24 mb-4",children:e.jsx(c,{className:"bg-purple-600 text-white text-2xl font-semibold",children:(e=>{const s=e.split(" ");return s.length>1?`${s[0][0]}${s[s.length-1][0]}`.toUpperCase():e.substring(0,2).toUpperCase()})(J)})}),e.jsx("h2",{className:"text-xl font-bold mb-1",children:J}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:null==D?void 0:D.email}),e.jsx(w,{variant:"secondary",className:"mb-4",children:"Student"}),e.jsx(S,{className:"my-4"}),e.jsxs("div",{className:"w-full space-y-3 text-left",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(E,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Grade:"}),e.jsx("span",{className:"font-medium",children:V})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(F,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Joined:"}),e.jsx("span",{className:"font-medium text-xs",children:(null==I?void 0:I.createdAt)?(K=I.createdAt,new Date(K).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})):"N/A"})]})]})]})]}),e.jsxs(h,{className:"lg:col-span-2",children:[e.jsxs(u,{children:[e.jsx(j,{children:"Edit Profile"}),e.jsx(g,{children:"Update your personal information"})]}),e.jsx(p,{children:e.jsxs("form",{onSubmit:async e=>{var s,a;if(e.preventDefault(),D&&I)try{H(!0);const e=await o(D.id,{fullName:J,age:Q?parseInt(Q):void 0,grade:V,schoolName:_});e&&(L(e),M({title:"Success",description:"Profile updated successfully"}))}catch(l){M({title:"Error",description:(null==(a=null==(s=null==l?void 0:l.response)?void 0:s.data)?void 0:a.error)||"Failed to update profile",variant:"destructive"})}finally{H(!1)}},className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"fullName",children:[e.jsx(k,{className:"w-4 h-4 inline mr-2"}),"Full Name"]}),e.jsx(m,{id:"fullName",type:"text",value:J,onChange:e=>O(e.target.value),placeholder:"Enter your full name",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"email",children:[e.jsx(A,{className:"w-4 h-4 inline mr-2"}),"Email"]}),e.jsx(m,{id:"email",type:"email",value:(null==D?void 0:D.email)||"",disabled:!0,className:"bg-muted"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Email cannot be changed. Contact support if needed."})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"age",children:"Age"}),e.jsx(m,{id:"age",type:"number",value:Q,onChange:e=>R(e.target.value),placeholder:"Enter your age",min:"5",max:"100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"grade",children:[e.jsx(E,{className:"w-4 h-4 inline mr-2"}),"Grade"]}),e.jsxs(N,{value:V,onValueChange:X,children:[e.jsx(f,{id:"grade",children:e.jsx(v,{placeholder:"Select grade"})}),e.jsxs(y,{children:[[1,2,3,4,5,6].map(s=>e.jsxs(b,{value:s.toString(),children:["Grade ",s]},s)),e.jsx(b,{value:"Common Entrance",children:"Common Entrance"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"schoolName",children:[e.jsx(P,{className:"w-4 h-4 inline mr-2"}),"School Name"]}),e.jsx(m,{id:"schoolName",type:"text",value:_,onChange:e=>z(e.target.value),placeholder:"Enter your school name"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(t,{type:"button",variant:"outline",onClick:()=>G("/dashboard"),children:"Cancel"}),e.jsxs(t,{type:"submit",disabled:q,className:"gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),q?"Saving...":"Save Changes"]})]})]})})]})]})]})})]});var K};export{D as default};
