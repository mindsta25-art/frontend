import{j as e,l as t,b as r,K as a,M as n,c as s,ae as l,u as i,h as o,i as d,g as c,a as u,af as f,ag as p,ah as m,ai as h,aj as v,d as x,e as g,k as j,n as b,p as y,O as w,q as N}from"./ui-BFkRrjhf.js";import{r as C}from"./vendor-ClsjX3Mm.js";import{g as E,u as A,B as S}from"./index-CgruMJ9X.js";import{C as k,b as R,c as P,a as I}from"./card-COhXL4y3.js";import{I as O}from"./input-K7STGv4F.js";import{L as _}from"./label-D_0g-RlU.js";import{T as F}from"./textarea-Cg6ZmrUp.js";import{B as D}from"./badge-CO1u2g-4.js";import{C as G}from"./checkbox-CPao0aTF.js";import{D as M,f as L,a as T,b as V,c as $,d as K,e as q}from"./dialog-CHNrEUkw.js";import{S as z,a as U,b as B,c as W,d as H}from"./select-BhEU0EIQ.js";import{O as Z,aM as Q,a1 as J,aT as X,aU as Y,aH as ee,a7 as te}from"./icons-Udnp6KR8.js";import{T as re,a as ae,b as ne,c as se,d as le,e as ie}from"./table-BkpA8L4u.js";import{A as oe}from"./AdminLayout-BWmn8TIL.js";import{f as de,c as ce,d as ue,u as fe,e as pe,t as me,h as he}from"./formatDistanceToNow-Bf1kdoXg.js";import"./charts-DeubIqjP.js";import"./scroll-area-DkFg0wM_.js";function ve(t){const r=xe(t),a=C.forwardRef((t,a)=>{const{children:n,...s}=t,l=C.Children.toArray(n),i=l.find(je);if(i){const t=i.props.children,n=l.map(e=>e===i?C.Children.count(t)>1?C.Children.only(null):C.isValidElement(t)?t.props.children:null:e);return e.jsx(r,{...s,ref:a,children:C.isValidElement(t)?C.cloneElement(t,void 0,n):null})}return e.jsx(r,{...s,ref:a,children:n})});return a.displayName=`${t}.Slot`,a}function xe(e){const r=C.forwardRef((e,r)=>{const{children:a,...n}=e;if(C.isValidElement(a)){const e=function(e){var t,r;let a=null==(t=Object.getOwnPropertyDescriptor(e.props,"ref"))?void 0:t.get,n=a&&"isReactWarning"in a&&a.isReactWarning;if(n)return e.ref;if(a=null==(r=Object.getOwnPropertyDescriptor(e,"ref"))?void 0:r.get,n=a&&"isReactWarning"in a&&a.isReactWarning,n)return e.props.ref;return e.props.ref||e.ref}(a),s=function(e,t){const r={...t};for(const a in t){const n=e[a],s=t[a];/^on[A-Z]/.test(a)?n&&s?r[a]=(...e)=>{const t=s(...e);return n(...e),t}:n&&(r[a]=n):"style"===a?r[a]={...n,...s}:"className"===a&&(r[a]=[n,s].filter(Boolean).join(" "))}return{...e,...r}}(n,a.props);return a.type!==C.Fragment&&(s.ref=r?t(r,e):e),C.cloneElement(a,s)}return C.Children.count(a)>1?C.Children.only(null):null});return r.displayName=`${e}.SlotClone`,r}var ge=Symbol("radix.slottable");function je(e){return C.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===ge}var be="Popover",[ye]=s(be,[r]),we=r(),[Ne,Ce]=ye(be),Ee=t=>{const{__scopePopover:r,children:s,open:i,defaultOpen:o,onOpenChange:d,modal:c=!1}=t,u=we(r),f=C.useRef(null),[p,m]=C.useState(!1),[h,v]=a({prop:i,defaultProp:o??!1,onChange:d,caller:be});return e.jsx(n,{...u,children:e.jsx(Ne,{scope:r,contentId:l(),triggerRef:f,open:h,onOpenChange:v,onOpenToggle:C.useCallback(()=>v(e=>!e),[v]),hasCustomAnchor:p,onCustomAnchorAdd:C.useCallback(()=>m(!0),[]),onCustomAnchorRemove:C.useCallback(()=>m(!1),[]),modal:c,children:s})})};Ee.displayName=be;var Ae="PopoverAnchor";C.forwardRef((t,r)=>{const{__scopePopover:a,...n}=t,s=Ce(Ae,a),l=we(a),{onCustomAnchorAdd:i,onCustomAnchorRemove:o}=s;return C.useEffect(()=>(i(),()=>o()),[i,o]),e.jsx(c,{...l,...n,ref:r})}).displayName=Ae;var Se="PopoverTrigger",ke=C.forwardRef((t,r)=>{const{__scopePopover:a,...n}=t,s=Ce(Se,a),l=we(a),u=i(r,s.triggerRef),f=e.jsx(o.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":Ve(s.open),...n,ref:u,onClick:d(t.onClick,s.onOpenToggle)});return s.hasCustomAnchor?f:e.jsx(c,{asChild:!0,...l,children:f})});ke.displayName=Se;var Re="PopoverPortal",[Pe,Ie]=ye(Re,{forceMount:void 0}),Oe=t=>{const{__scopePopover:r,forceMount:a,children:n,container:s}=t,l=Ce(Re,r);return e.jsx(Pe,{scope:r,forceMount:a,children:e.jsx(u,{present:a||l.open,children:e.jsx(f,{asChild:!0,container:s,children:n})})})};Oe.displayName=Re;var _e="PopoverContent",Fe=C.forwardRef((t,r)=>{const a=Ie(_e,t.__scopePopover),{forceMount:n=a.forceMount,...s}=t,l=Ce(_e,t.__scopePopover);return e.jsx(u,{present:n||l.open,children:l.modal?e.jsx(Ge,{...s,ref:r}):e.jsx(Me,{...s,ref:r})})});Fe.displayName=_e;var De=ve("PopoverContent.RemoveScroll"),Ge=C.forwardRef((t,r)=>{const a=Ce(_e,t.__scopePopover),n=C.useRef(null),s=i(r,n),l=C.useRef(!1);return C.useEffect(()=>{const e=n.current;if(e)return p(e)},[]),e.jsx(m,{as:De,allowPinchZoom:!0,children:e.jsx(Le,{...t,ref:s,trapFocus:a.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:d(t.onCloseAutoFocus,e=>{var t;e.preventDefault(),l.current||null==(t=a.triggerRef.current)||t.focus()}),onPointerDownOutside:d(t.onPointerDownOutside,e=>{const t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey,a=2===t.button||r;l.current=a},{checkForDefaultPrevented:!1}),onFocusOutside:d(t.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1})})})}),Me=C.forwardRef((t,r)=>{const a=Ce(_e,t.__scopePopover),n=C.useRef(!1),s=C.useRef(!1);return e.jsx(Le,{...t,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:e=>{var r,l;null==(r=t.onCloseAutoFocus)||r.call(t,e),e.defaultPrevented||(n.current||null==(l=a.triggerRef.current)||l.focus(),e.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:e=>{var r,l;null==(r=t.onInteractOutside)||r.call(t,e),e.defaultPrevented||(n.current=!0,"pointerdown"===e.detail.originalEvent.type&&(s.current=!0));const i=e.target;(null==(l=a.triggerRef.current)?void 0:l.contains(i))&&e.preventDefault(),"focusin"===e.detail.originalEvent.type&&s.current&&e.preventDefault()}})}),Le=C.forwardRef((t,r)=>{const{__scopePopover:a,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:l,disableOutsidePointerEvents:i,onEscapeKeyDown:o,onPointerDownOutside:d,onFocusOutside:c,onInteractOutside:u,...f}=t,p=Ce(_e,a),m=we(a);return h(),e.jsx(v,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:l,children:e.jsx(x,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:u,onEscapeKeyDown:o,onPointerDownOutside:d,onFocusOutside:c,onDismiss:()=>p.onOpenChange(!1),children:e.jsx(g,{"data-state":Ve(p.open),role:"dialog",id:p.contentId,...m,...f,ref:r,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Te="PopoverClose";C.forwardRef((t,r)=>{const{__scopePopover:a,...n}=t,s=Ce(Te,a);return e.jsx(o.button,{type:"button",...n,ref:r,onClick:d(t.onClick,()=>s.onOpenChange(!1))})}).displayName=Te;function Ve(e){return e?"open":"closed"}C.forwardRef((t,r)=>{const{__scopePopover:a,...n}=t,s=we(a);return e.jsx(j,{...s,...n,ref:r})}).displayName="PopoverArrow";var $e=Oe,Ke=Fe;const qe=Ee,ze=ke,Ue=C.forwardRef(({className:t,align:r="center",sideOffset:a=4,...n},s)=>e.jsx($e,{children:e.jsx(Ke,{ref:s,align:r,sideOffset:a,className:E("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}));Ue.displayName=Ke.displayName;var Be=.999,We=/[\\\/_+.#"@\[\(\{&]/,He=/[\\\/_+.#"@\[\(\{&]/g,Ze=/[\s-]/,Qe=/[\s-]/g;function Je(e,t,r,a,n,s,l){if(s===t.length)return n===e.length?1:.99;var i=`${n},${s}`;if(void 0!==l[i])return l[i];for(var o,d,c,u,f=a.charAt(s),p=r.indexOf(f,n),m=0;p>=0;)(o=Je(e,t,r,a,p+1,s+1,l))>m&&(p===n?o*=1:We.test(e.charAt(p-1))?(o*=.8,(c=e.slice(n,p-1).match(He))&&n>0&&(o*=Math.pow(Be,c.length))):Ze.test(e.charAt(p-1))?(o*=.9,(u=e.slice(n,p-1).match(Qe))&&n>0&&(o*=Math.pow(Be,u.length))):(o*=.17,n>0&&(o*=Math.pow(Be,p-n))),e.charAt(p)!==t.charAt(s)&&(o*=.9999)),(o<.1&&r.charAt(p-1)===a.charAt(s+1)||a.charAt(s+1)===a.charAt(s)&&r.charAt(p-1)!==a.charAt(s))&&(.1*(d=Je(e,t,r,a,p+1,s+2,l))>o&&(o=.1*d)),o>m&&(m=o),p=r.indexOf(f,p+1);return l[i]=m,m}function Xe(e){return e.toLowerCase().replace(Qe," ")}function Ye(e,t,r){return Je(e=r&&r.length>0?""+(e+" "+r.join(" ")):e,t,Xe(e),Xe(t),0,0,{})}var et='[cmdk-group=""]',tt='[cmdk-group-items=""]',rt='[cmdk-item=""]',at=`${rt}:not([aria-disabled="true"])`,nt="cmdk-item-select",st="data-value",lt=(e,t,r)=>Ye(e,t,r),it=C.createContext(void 0),ot=()=>C.useContext(it),dt=C.createContext(void 0),ct=()=>C.useContext(dt),ut=C.createContext(void 0),ft=C.forwardRef((e,t)=>{let r=At(()=>{var t,r;return{search:"",value:null!=(r=null!=(t=e.value)?t:e.defaultValue)?r:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),a=At(()=>new Set),n=At(()=>new Map),s=At(()=>new Map),i=At(()=>new Set),d=Ct(e),{label:c,children:u,value:f,onValueChange:p,filter:m,shouldFilter:h,loop:v,disablePointerSelection:x=!1,vimBindings:g=!0,...j}=e,b=l(),y=l(),w=l(),N=C.useRef(null),E=Rt();Et(()=>{if(void 0!==f){let e=f.trim();r.current.value=e,A.emit()}},[f]),Et(()=>{E(6,O)},[]);let A=C.useMemo(()=>({subscribe:e=>(i.current.add(e),()=>i.current.delete(e)),snapshot:()=>r.current,setState:(e,t,a)=>{var n,s,l,i;if(!Object.is(r.current[e],t)){if(r.current[e]=t,"search"===e)I(),R(),E(1,P);else if("value"===e){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let e=document.getElementById(w);e?e.focus():null==(n=document.getElementById(b))||n.focus()}if(E(7,()=>{var e;r.current.selectedItemId=null==(e=_())?void 0:e.id,A.emit()}),a||E(5,O),void 0!==(null==(s=d.current)?void 0:s.value)){let e=null!=t?t:"";return void(null==(i=(l=d.current).onValueChange)||i.call(l,e))}}A.emit()}},emit:()=>{i.current.forEach(e=>e())}}),[]),S=C.useMemo(()=>({value:(e,t,a)=>{var n;t!==(null==(n=s.current.get(e))?void 0:n.value)&&(s.current.set(e,{value:t,keywords:a}),r.current.filtered.items.set(e,k(t,a)),E(2,()=>{R(),A.emit()}))},item:(e,t)=>(a.current.add(e),t&&(n.current.has(t)?n.current.get(t).add(e):n.current.set(t,new Set([e]))),E(3,()=>{I(),R(),r.current.value||P(),A.emit()}),()=>{s.current.delete(e),a.current.delete(e),r.current.filtered.items.delete(e);let t=_();E(4,()=>{I(),(null==t?void 0:t.getAttribute("id"))===e&&P(),A.emit()})}),group:e=>(n.current.has(e)||n.current.set(e,new Set),()=>{s.current.delete(e),n.current.delete(e)}),filter:()=>d.current.shouldFilter,label:c||e["aria-label"],getDisablePointerSelection:()=>d.current.disablePointerSelection,listId:b,inputId:w,labelId:y,listInnerRef:N}),[]);function k(e,t){var a,n;let s=null!=(n=null==(a=d.current)?void 0:a.filter)?n:lt;return e?s(e,r.current.search,t):0}function R(){if(!r.current.search||!1===d.current.shouldFilter)return;let e=r.current.filtered.items,t=[];r.current.filtered.groups.forEach(r=>{let a=n.current.get(r),s=0;a.forEach(t=>{let r=e.get(t);s=Math.max(r,s)}),t.push([r,s])});let a=N.current;F().sort((t,r)=>{var a,n;let s=t.getAttribute("id"),l=r.getAttribute("id");return(null!=(a=e.get(l))?a:0)-(null!=(n=e.get(s))?n:0)}).forEach(e=>{let t=e.closest(tt);t?t.appendChild(e.parentElement===t?e:e.closest(`${tt} > *`)):a.appendChild(e.parentElement===a?e:e.closest(`${tt} > *`))}),t.sort((e,t)=>t[1]-e[1]).forEach(e=>{var t;let r=null==(t=N.current)?void 0:t.querySelector(`${et}[${st}="${encodeURIComponent(e[0])}"]`);null==r||r.parentElement.appendChild(r)})}function P(){let e=F().find(e=>"true"!==e.getAttribute("aria-disabled")),t=null==e?void 0:e.getAttribute(st);A.setState("value",t||void 0)}function I(){var e,t,l,i;if(!r.current.search||!1===d.current.shouldFilter)return void(r.current.filtered.count=a.current.size);r.current.filtered.groups=new Set;let o=0;for(let n of a.current){let a=k(null!=(t=null==(e=s.current.get(n))?void 0:e.value)?t:"",null!=(i=null==(l=s.current.get(n))?void 0:l.keywords)?i:[]);r.current.filtered.items.set(n,a),a>0&&o++}for(let[a,s]of n.current)for(let e of s)if(r.current.filtered.items.get(e)>0){r.current.filtered.groups.add(a);break}r.current.filtered.count=o}function O(){var e,t,r;let a=_();a&&((null==(e=a.parentElement)?void 0:e.firstChild)===a&&(null==(r=null==(t=a.closest(et))?void 0:t.querySelector('[cmdk-group-heading=""]'))||r.scrollIntoView({block:"nearest"})),a.scrollIntoView({block:"nearest"}))}function _(){var e;return null==(e=N.current)?void 0:e.querySelector(`${rt}[aria-selected="true"]`)}function F(){var e;return Array.from((null==(e=N.current)?void 0:e.querySelectorAll(at))||[])}function D(e){let t=F()[e];t&&A.setState("value",t.getAttribute(st))}function G(e){var t;let r=_(),a=F(),n=a.findIndex(e=>e===r),s=a[n+e];null!=(t=d.current)&&t.loop&&(s=n+e<0?a[a.length-1]:n+e===a.length?a[0]:a[n+e]),s&&A.setState("value",s.getAttribute(st))}function M(e){let t,r=_(),a=null==r?void 0:r.closest(et);for(;a&&!t;)a=e>0?wt(a,et):Nt(a,et),t=null==a?void 0:a.querySelector(at);t?A.setState("value",t.getAttribute(st)):G(e)}let L=()=>D(F().length-1),T=e=>{e.preventDefault(),e.metaKey?L():e.altKey?M(1):G(1)},V=e=>{e.preventDefault(),e.metaKey?D(0):e.altKey?M(-1):G(-1)};return C.createElement(o.div,{ref:t,tabIndex:-1,...j,"cmdk-root":"",onKeyDown:e=>{var t;null==(t=j.onKeyDown)||t.call(j,e);let r=e.nativeEvent.isComposing||229===e.keyCode;if(!e.defaultPrevented&&!r)switch(e.key){case"n":case"j":g&&e.ctrlKey&&T(e);break;case"ArrowDown":T(e);break;case"p":case"k":g&&e.ctrlKey&&V(e);break;case"ArrowUp":V(e);break;case"Home":e.preventDefault(),D(0);break;case"End":e.preventDefault(),L();break;case"Enter":{e.preventDefault();let t=_();if(t){let e=new Event(nt);t.dispatchEvent(e)}}}}},C.createElement("label",{"cmdk-label":"",htmlFor:S.inputId,id:S.labelId,style:It},c),Pt(e,e=>C.createElement(dt.Provider,{value:A},C.createElement(it.Provider,{value:S},e))))}),pt=C.forwardRef((e,r)=>{var a,n;let s=l(),i=C.useRef(null),d=C.useContext(ut),c=ot(),u=Ct(e),f=null!=(n=null==(a=u.current)?void 0:a.forceMount)?n:null==d?void 0:d.forceMount;Et(()=>{if(!f)return c.item(s,null==d?void 0:d.id)},[f]);let p=kt(s,i,[e.value,e.children,i],e.keywords),m=ct(),h=St(e=>e.value&&e.value===p.current),v=St(e=>!(!f&&!1!==c.filter())||(!e.search||e.filtered.items.get(s)>0));function x(){var e,t;g(),null==(t=(e=u.current).onSelect)||t.call(e,p.current)}function g(){m.setState("value",p.current,!0)}if(C.useEffect(()=>{let t=i.current;if(t&&!e.disabled)return t.addEventListener(nt,x),()=>t.removeEventListener(nt,x)},[v,e.onSelect,e.disabled]),!v)return null;let{disabled:j,value:b,onSelect:y,forceMount:w,keywords:N,...E}=e;return C.createElement(o.div,{ref:t(i,r),...E,id:s,"cmdk-item":"",role:"option","aria-disabled":!!j,"aria-selected":!!h,"data-disabled":!!j,"data-selected":!!h,onPointerMove:j||c.getDisablePointerSelection()?void 0:g,onClick:j?void 0:x},e.children)}),mt=C.forwardRef((e,r)=>{let{heading:a,children:n,forceMount:s,...i}=e,d=l(),c=C.useRef(null),u=C.useRef(null),f=l(),p=ot(),m=St(e=>!(!s&&!1!==p.filter())||(!e.search||e.filtered.groups.has(d)));Et(()=>p.group(d),[]),kt(d,c,[e.value,e.heading,u]);let h=C.useMemo(()=>({id:d,forceMount:s}),[s]);return C.createElement(o.div,{ref:t(c,r),...i,"cmdk-group":"",role:"presentation",hidden:!m||void 0},a&&C.createElement("div",{ref:u,"cmdk-group-heading":"","aria-hidden":!0,id:f},a),Pt(e,e=>C.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":a?f:void 0},C.createElement(ut.Provider,{value:h},e))))}),ht=C.forwardRef((e,r)=>{let{alwaysRender:a,...n}=e,s=C.useRef(null),l=St(e=>!e.search);return a||l?C.createElement(o.div,{ref:t(s,r),...n,"cmdk-separator":"",role:"separator"}):null}),vt=C.forwardRef((e,t)=>{let{onValueChange:r,...a}=e,n=null!=e.value,s=ct(),l=St(e=>e.search),i=St(e=>e.selectedItemId),d=ot();return C.useEffect(()=>{null!=e.value&&s.setState("search",e.value)},[e.value]),C.createElement(o.input,{ref:t,...a,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":d.listId,"aria-labelledby":d.labelId,"aria-activedescendant":i,id:d.inputId,type:"text",value:n?e.value:l,onChange:e=>{n||s.setState("search",e.target.value),null==r||r(e.target.value)}})}),xt=C.forwardRef((e,r)=>{let{children:a,label:n="Suggestions",...s}=e,l=C.useRef(null),i=C.useRef(null),d=St(e=>e.selectedItemId),c=ot();return C.useEffect(()=>{if(i.current&&l.current){let e,t=i.current,r=l.current,a=new ResizeObserver(()=>{e=requestAnimationFrame(()=>{let e=t.offsetHeight;r.style.setProperty("--cmdk-list-height",e.toFixed(1)+"px")})});return a.observe(t),()=>{cancelAnimationFrame(e),a.unobserve(t)}}},[]),C.createElement(o.div,{ref:t(l,r),...s,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":d,"aria-label":n,id:c.listId},Pt(e,e=>C.createElement("div",{ref:t(i,c.listInnerRef),"cmdk-list-sizer":""},e)))}),gt=C.forwardRef((e,t)=>{let{open:r,onOpenChange:a,overlayClassName:n,contentClassName:s,container:l,...i}=e;return C.createElement(b,{open:r,onOpenChange:a},C.createElement(y,{container:l},C.createElement(w,{"cmdk-overlay":"",className:n}),C.createElement(N,{"aria-label":e.label,"cmdk-dialog":"",className:s},C.createElement(ft,{ref:t,...i}))))}),jt=C.forwardRef((e,t)=>St(e=>0===e.filtered.count)?C.createElement(o.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),bt=C.forwardRef((e,t)=>{let{progress:r,children:a,label:n="Loading...",...s}=e;return C.createElement(o.div,{ref:t,...s,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":n},Pt(e,e=>C.createElement("div",{"aria-hidden":!0},e)))}),yt=Object.assign(ft,{List:xt,Item:pt,Input:vt,Group:mt,Separator:ht,Dialog:gt,Empty:jt,Loading:bt});function wt(e,t){let r=e.nextElementSibling;for(;r;){if(r.matches(t))return r;r=r.nextElementSibling}}function Nt(e,t){let r=e.previousElementSibling;for(;r;){if(r.matches(t))return r;r=r.previousElementSibling}}function Ct(e){let t=C.useRef(e);return Et(()=>{t.current=e}),t}var Et="undefined"==typeof window?C.useEffect:C.useLayoutEffect;function At(e){let t=C.useRef();return void 0===t.current&&(t.current=e()),t}function St(e){let t=ct(),r=()=>e(t.snapshot());return C.useSyncExternalStore(t.subscribe,r,r)}function kt(e,t,r,a=[]){let n=C.useRef(),s=ot();return Et(()=>{var l;let i=(()=>{var e;for(let t of r){if("string"==typeof t)return t.trim();if("object"==typeof t&&"current"in t)return t.current?null==(e=t.current.textContent)?void 0:e.trim():n.current}})(),o=a.map(e=>e.trim());s.value(e,i,o),null==(l=t.current)||l.setAttribute(st,i),n.current=i}),n}var Rt=()=>{let[e,t]=C.useState(),r=At(()=>new Map);return Et(()=>{r.current.forEach(e=>e()),r.current=new Map},[e]),(e,a)=>{r.current.set(e,a),t({})}};function Pt({asChild:e,children:t},r){return e&&C.isValidElement(t)?C.cloneElement(function(e){let t=e.type;return"function"==typeof t?t(e.props):"render"in t?t.render(e.props):e}(t),{ref:t.ref},r(t.props.children)):r(t)}var It={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Ot=C.forwardRef(({className:t,...r},a)=>e.jsx(yt,{ref:a,className:E("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...r}));Ot.displayName=yt.displayName;const _t=C.forwardRef(({className:t,...r},a)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(Z,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(yt.Input,{ref:a,className:E("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...r})]}));_t.displayName=yt.Input.displayName;const Ft=C.forwardRef(({className:t,...r},a)=>e.jsx(yt.List,{ref:a,className:E("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...r}));Ft.displayName=yt.List.displayName;const Dt=C.forwardRef((t,r)=>e.jsx(yt.Empty,{ref:r,className:"py-6 text-center text-sm",...t}));Dt.displayName=yt.Empty.displayName;const Gt=C.forwardRef(({className:t,...r},a)=>e.jsx(yt.Group,{ref:a,className:E("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...r}));Gt.displayName=yt.Group.displayName;C.forwardRef(({className:t,...r},a)=>e.jsx(yt.Separator,{ref:a,className:E("-mx-1 h-px bg-border",t),...r})).displayName=yt.Separator.displayName;const Mt=C.forwardRef(({className:t,...r},a)=>e.jsx(yt.Item,{ref:a,className:E("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",t),...r}));Mt.displayName=yt.Item.displayName;const Lt=[{value:1,label:"Grade 1"},{value:2,label:"Grade 2"},{value:3,label:"Grade 3"},{value:4,label:"Grade 4"},{value:5,label:"Grade 5"},{value:6,label:"Grade 6"},{value:7,label:"Common Entrance"}],Tt=()=>{const[t,r]=C.useState([]),[a,n]=C.useState(null),[s,l]=C.useState(!1),[i,o]=C.useState(!1),[d,c]=C.useState(null),[u,f]=C.useState(""),[p,m]=C.useState(!1),{toast:h}=A(),[v,x]=C.useState({title:"",message:"",type:"info",priority:"medium",targetGrades:[],expiresAt:""}),g=async()=>{try{l(!0);const e=await ce();r(e.notifications||e)}catch(e){h({title:"Error",description:"Failed to fetch notifications",variant:"destructive"})}finally{l(!1)}},j=async()=>{try{const e=await ue();n(e)}catch(e){}};C.useEffect(()=>{g(),j()},[]);const b=()=>{x({title:"",message:"",type:"info",priority:"medium",targetGrades:[],expiresAt:""}),c(null)},y=t.filter(e=>e.title.toLowerCase().includes(u.toLowerCase())||e.message.toLowerCase().includes(u.toLowerCase()));return e.jsx(oe,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Notification Management"}),a&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs(k,{children:[e.jsx(R,{className:"pb-3",children:e.jsx(P,{className:"text-sm font-medium text-muted-foreground",children:"Total"})}),e.jsx(I,{children:e.jsx("div",{className:"text-2xl font-bold",children:a.total})})]}),e.jsxs(k,{children:[e.jsx(R,{className:"pb-3",children:e.jsx(P,{className:"text-sm font-medium text-muted-foreground",children:"Active"})}),e.jsx(I,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:a.active})})]}),e.jsxs(k,{children:[e.jsx(R,{className:"pb-3",children:e.jsx(P,{className:"text-sm font-medium text-muted-foreground",children:"Inactive"})}),e.jsx(I,{children:e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:a.inactive})})]}),e.jsxs(k,{children:[e.jsx(R,{className:"pb-3",children:e.jsx(P,{className:"text-sm font-medium text-muted-foreground",children:"Expired"})}),e.jsx(I,{children:e.jsx("div",{className:"text-2xl font-bold text-red-600",children:a.expired})})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(O,{placeholder:"Search notifications...",value:u,onChange:e=>f(e.target.value),className:"pl-10"})]}),e.jsxs(M,{open:i,onOpenChange:e=>{o(e),e||b()},children:[e.jsx(L,{asChild:!0,children:e.jsxs(S,{children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Create Notification"]})}),e.jsxs(T,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(V,{children:[e.jsx($,{children:d?"Edit Notification":"Create New Notification"}),e.jsx(K,{children:"Send notifications to students about announcements, updates, or important information"})]}),e.jsxs("form",{onSubmit:async e=>{var t,r;if(e.preventDefault(),v.title.trim())if(v.message.trim())if(0!==v.targetGrades.length)try{l(!0);const e={...v,targetAudience:"grade-specific",expiresAt:v.expiresAt?new Date(v.expiresAt):null};if(d){await fe(d._id,e);h({title:"Notification updated",description:"The notification has been updated successfully"})}else{await pe(e);h({title:"Notification created",description:"The notification has been sent to students"})}o(!1),b(),g(),j()}catch(a){const e=(null==(r=null==(t=null==a?void 0:a.response)?void 0:t.data)?void 0:r.message)||(null==a?void 0:a.message)||"Failed to save notification";h({title:"Error",description:e,variant:"destructive"})}finally{l(!1)}else h({title:"Validation Error",description:"Please select at least one grade",variant:"destructive"});else h({title:"Validation Error",description:"Please enter a message",variant:"destructive"});else h({title:"Validation Error",description:"Please enter a title",variant:"destructive"})},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"title",children:"Title *"}),e.jsx(O,{id:"title",value:v.title,onChange:e=>x({...v,title:e.target.value}),placeholder:"Notification title",required:!0})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"message",children:"Message *"}),e.jsx(F,{id:"message",value:v.message,onChange:e=>x({...v,message:e.target.value}),placeholder:"Notification message",rows:4,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{htmlFor:"type",children:"Type"}),e.jsxs(z,{value:v.type,onValueChange:e=>x({...v,type:e}),children:[e.jsx(U,{children:e.jsx(B,{})}),e.jsxs(W,{children:[e.jsx(H,{value:"info",children:"Info"}),e.jsx(H,{value:"warning",children:"Warning"}),e.jsx(H,{value:"success",children:"Success"}),e.jsx(H,{value:"announcement",children:"Announcement"}),e.jsx(H,{value:"update",children:"Update"})]})]})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"priority",children:"Priority"}),e.jsxs(z,{value:v.priority,onValueChange:e=>x({...v,priority:e}),children:[e.jsx(U,{children:e.jsx(B,{})}),e.jsxs(W,{children:[e.jsx(H,{value:"low",children:"Low"}),e.jsx(H,{value:"medium",children:"Medium"}),e.jsx(H,{value:"high",children:"High"}),e.jsx(H,{value:"urgent",children:"Urgent"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"targetGrades",children:"Target Grades *"}),e.jsxs(qe,{open:p,onOpenChange:m,children:[e.jsx(ze,{asChild:!0,children:e.jsxs(S,{variant:"outline",role:"combobox","aria-expanded":p,className:"w-full justify-between",children:[0===v.targetGrades.length?"Select grades...":v.targetGrades.length===Lt.length?"All grades selected":`${v.targetGrades.length} grade${v.targetGrades.length>1?"s":""} selected`,e.jsx(J,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Ue,{className:"w-full p-0",align:"start",children:e.jsxs(Ot,{children:[e.jsx(_t,{placeholder:"Search grades..."}),e.jsxs(Ft,{children:[e.jsx(Dt,{children:"No grade found."}),e.jsx(Gt,{children:Lt.map(t=>e.jsx(Mt,{onSelect:()=>{x({...v,targetGrades:v.targetGrades.includes(t.value)?v.targetGrades.filter(e=>e!==t.value):[...v.targetGrades,t.value]})},children:e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx(G,{checked:v.targetGrades.includes(t.value),onCheckedChange:()=>{x({...v,targetGrades:v.targetGrades.includes(t.value)?v.targetGrades.filter(e=>e!==t.value):[...v.targetGrades,t.value]})}}),e.jsx("span",{children:t.label})]})},t.value))})]})]})})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Select one or more grades to target with this notification"}),v.targetGrades.length>0&&e.jsx("div",{className:"flex gap-2 flex-wrap mt-2",children:v.targetGrades.sort((e,t)=>e-t).map(t=>{var r;const a=null==(r=Lt.find(e=>e.value===t))?void 0:r.label;return e.jsx(D,{variant:"secondary",children:a},t)})})]}),e.jsxs("div",{children:[e.jsx(_,{htmlFor:"expiresAt",children:"Expiration Date (Optional)"}),e.jsx(O,{id:"expiresAt",type:"datetime-local",value:v.expiresAt,onChange:e=>x({...v,expiresAt:e.target.value})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Leave empty for notification that never expires"})]}),e.jsxs(q,{children:[e.jsx(S,{type:"button",variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx(S,{type:"submit",disabled:s,children:s?"Saving...":d?"Update":"Create"})]})]})]})]})]}),e.jsx(k,{children:e.jsx(I,{className:"p-0",children:e.jsxs(re,{children:[e.jsx(ae,{children:e.jsxs(ne,{children:[e.jsx(se,{children:"Title"}),e.jsx(se,{children:"Type"}),e.jsx(se,{children:"Priority"}),e.jsx(se,{children:"Target"}),e.jsx(se,{children:"Status"}),e.jsx(se,{children:"Created"}),e.jsx(se,{className:"text-right",children:"Actions"})]})}),e.jsx(le,{children:s?e.jsx(ne,{children:e.jsx(ie,{colSpan:7,className:"text-center py-8",children:"Loading notifications..."})}):0===y.length?e.jsx(ne,{children:e.jsx(ie,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No notifications found"})}):y.map(t=>{return e.jsxs(ne,{children:[e.jsx(ie,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.title}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1",children:t.message})]})}),e.jsx(ie,{children:e.jsx(D,{variant:(n=t.type,{info:"default",warning:"destructive",success:"default",announcement:"default",update:"secondary"}[n]||"default"),children:t.type})}),e.jsx(ie,{children:e.jsx(D,{className:(a=t.priority,{low:"bg-gray-100 text-gray-800",medium:"bg-blue-100 text-blue-800",high:"bg-orange-100 text-orange-800",urgent:"bg-red-100 text-red-800"}[a]||"bg-gray-100 text-gray-800"),children:t.priority})}),e.jsx(ie,{children:(r=t.targetGrades||[],r.map(e=>7===e?"Common Entrance":`Grade ${e}`).join(", "))}),e.jsx(ie,{children:e.jsx(D,{variant:t.isActive?"default":"secondary",children:t.isActive?"Active":"Inactive"})}),e.jsx(ie,{children:e.jsx("span",{className:"text-sm text-muted-foreground",children:de(new Date(t.createdAt),{addSuffix:!0})})}),e.jsx(ie,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>(async e=>{try{await me(e),h({title:"Status updated",description:"Notification status has been toggled"}),g(),j()}catch(t){h({title:"Error",description:"Failed to toggle notification status",variant:"destructive"})}})(t._id),children:t.isActive?e.jsx(X,{className:"w-4 h-4"}):e.jsx(Y,{className:"w-4 h-4"})}),e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>(e=>{c(e),x({title:e.title,message:e.message,type:e.type,priority:e.priority,targetGrades:e.targetGrades||[],expiresAt:e.expiresAt?new Date(e.expiresAt).toISOString().slice(0,16):""}),o(!0)})(t),children:e.jsx(ee,{className:"w-4 h-4"})}),e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this notification?"))try{await he(e),h({title:"Notification deleted",description:"The notification has been deleted"}),g(),j()}catch(t){h({title:"Error",description:"Failed to delete notification",variant:"destructive"})}})(t._id),children:e.jsx(te,{className:"w-4 h-4 text-red-600"})})]})})]},t._id);var r,a,n})})]})})})]})})};export{Tt as default};
