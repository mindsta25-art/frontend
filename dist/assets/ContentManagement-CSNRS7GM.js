import{j as e}from"./ui-BFkRrjhf.js";import{r as s,i as l}from"./vendor-ClsjX3Mm.js";import{C as t,b as i,c as a,a as r,d as n}from"./card-COhXL4y3.js";import{T as c,a as d,b as o,c as u}from"./tabs-C0D04NFg.js";import{B as h,u as x}from"./index-CgruMJ9X.js";import{I as m}from"./input-K7STGv4F.js";import{B as j}from"./badge-CO1u2g-4.js";import{L as p}from"./label-D_0g-RlU.js";import{T as v}from"./textarea-Cg6ZmrUp.js";import{S as g,a as f,b as N,c as y,d as b}from"./select-BhEU0EIQ.js";import{D as C,a as w,b as S,c as z,d as T,e as F}from"./dialog-CHNrEUkw.js";import{T as k,a as L,b as q,c as A,d as I,e as D}from"./table-BkpA8L4u.js";import{C as U}from"./checkbox-CPao0aTF.js";import{A as V}from"./AdminLayout-BWmn8TIL.js";import{aM as E,aO as Q,aB as G,X as M,W as P,D as $,aH as O,a7 as B,aP as R,a0 as Y,ad as W,B as J,A as H,O as _,av as K}from"./icons-Udnp6KR8.js";import{getAllLessons as X,updateLesson as Z,createLesson as ee,deleteLesson as se}from"./lessons-BDW73QPv.js";import{a as le,u as te,c as ie,d as ae}from"./quizzes-aJK__rGY.js";import{A as re,m as ne}from"./animations-B9X9lRsG.js";import"./charts-DeubIqjP.js";import"./scroll-area-DkFg0wM_.js";const ce=({curriculum:l,onChange:n})=>{const[c,d]=s.useState(new Set([0])),[o,u]=s.useState(null),[x,C]=s.useState(null),[w,S]=s.useState(null),[z,T]=s.useState({title:"",description:""}),[F,k]=s.useState({title:"",type:"article",content:"",videoUrl:"",duration:0}),[L,q]=s.useState({title:"",type:"link",url:"",description:""}),A=(e,s)=>{const t=[...l];t[e]={...t[e],...s},n(t),u(null)},I=(e,s,t)=>{const i=[...l];i[e].lectures[s]={...i[e].lectures[s],...t},n(i),C(null)},D=(e,s)=>{if("up"===s&&0===e)return;if("down"===s&&e===l.length-1)return;const t=[...l],i="up"===s?e-1:e+1;[t[e],t[i]]=[t[i],t[e]],t[e].order=e,t[i].order=i,n(t)},U=(e,s,t)=>{const i=l[e].lectures;if("up"===t&&0===s)return;if("down"===t&&s===i.length-1)return;const a=[...l],r="up"===t?s-1:s+1;[a[e].lectures[s],a[e].lectures[r]]=[a[e].lectures[r],a[e].lectures[s]],a[e].lectures[s].order=s,a[e].lectures[r].order=r,n(a)},V=e=>{const s=Math.floor(e/60),l=e%60;return s>0?`${s}h ${l}m`:`${l}m`};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(t,{children:[e.jsx(i,{children:e.jsx(a,{className:"text-lg",children:"Curriculum Overview"})}),e.jsx(r,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:l.length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Sections"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:l.reduce((e,s)=>e+s.lectures.length,0)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Lectures"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:V(l.reduce((e,s)=>e+s.lectures.reduce((e,s)=>e+(s.duration||0),0),0))}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Duration"})]})]})})]}),e.jsxs(t,{children:[e.jsx(i,{children:e.jsx(a,{className:"text-base",children:"Add New Section"})}),e.jsxs(r,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"sectionTitle",children:"Section Title *"}),e.jsx(m,{id:"sectionTitle",value:z.title,onChange:e=>T({...z,title:e.target.value}),placeholder:"e.g., Introduction to the Topic"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"sectionDescription",children:"Section Description"}),e.jsx(v,{id:"sectionDescription",value:z.description,onChange:e=>T({...z,description:e.target.value}),placeholder:"Optional: Describe what this section covers",rows:2})]}),e.jsxs(h,{onClick:()=>{if(!z.title.trim())return;const e={title:z.title,description:z.description,order:l.length,lectures:[]};n([...l,e]),T({title:"",description:""}),d(new Set([...c,l.length]))},disabled:!z.title.trim(),className:"w-full gap-2",children:[e.jsx(E,{className:"w-4 h-4"}),"Add Section"]})]})]}),e.jsx("div",{className:"space-y-3",children:l.map((s,a)=>e.jsxs(t,{className:"border-2",children:[e.jsx(i,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex items-start gap-2 flex-1",children:[e.jsx(Q,{className:"w-5 h-5 text-muted-foreground mt-1 cursor-move"}),e.jsx("div",{className:"flex-1",children:o===a?e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{value:s.title,onChange:e=>A(a,{title:e.target.value}),placeholder:"Section title"}),e.jsx(v,{value:s.description||"",onChange:e=>A(a,{description:e.target.value}),placeholder:"Section description",rows:2}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{size:"sm",onClick:()=>u(null),children:e.jsx(G,{className:"w-4 h-4"})}),e.jsx(h,{size:"sm",variant:"ghost",onClick:()=>u(null),children:e.jsx(M,{className:"w-4 h-4"})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{variant:"ghost",size:"sm",className:"p-0 h-auto",onClick:()=>(e=>{const s=new Set(c);s.has(e)?s.delete(e):s.add(e),d(s)})(a),children:c.has(a)?e.jsx(P,{className:"w-5 h-5"}):e.jsx($,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold",children:["Section ",a+1,": ",s.title]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]})]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsxs(j,{variant:"secondary",children:[s.lectures.length," lectures"]}),e.jsx(j,{variant:"outline",children:V(s.lectures.reduce((e,s)=>e+(s.duration||0),0))})]})]})})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>D(a,"up"),disabled:0===a,children:"â†‘"}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>D(a,"down"),disabled:a===l.length-1,children:"â†“"}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>u(a),children:e.jsx(O,{className:"w-4 h-4"})}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>(e=>{if(!confirm("Delete this section and all its lectures?"))return;const s=l.filter((s,l)=>l!==e);n(s)})(a),children:e.jsx(B,{className:"w-4 h-4 text-destructive"})})]})]})}),c.has(a)&&e.jsxs(r,{className:"space-y-3 pt-0",children:[e.jsx("div",{className:"space-y-2 ml-7",children:s.lectures.map((i,c)=>e.jsx(t,{className:"bg-muted/50",children:e.jsx(r,{className:"p-3",children:(null==x?void 0:x.sectionIdx)===a&&(null==x?void 0:x.lectureIdx)===c?e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{value:i.title,onChange:e=>I(a,c,{title:e.target.value}),placeholder:"Lecture title"}),e.jsxs(g,{value:i.type,onValueChange:e=>I(a,c,{type:e}),children:[e.jsx(f,{children:e.jsx(N,{})}),e.jsxs(y,{children:[e.jsx(b,{value:"video",children:"Video"}),e.jsx(b,{value:"article",children:"Article"}),e.jsx(b,{value:"quiz",children:"Quiz"}),e.jsx(b,{value:"assignment",children:"Assignment"})]})]}),"video"===i.type&&e.jsx(m,{value:i.videoUrl||"",onChange:e=>I(a,c,{videoUrl:e.target.value}),placeholder:"Video URL"}),("article"===i.type||"assignment"===i.type)&&e.jsx(v,{value:i.content||"",onChange:e=>I(a,c,{content:e.target.value}),placeholder:"Lecture content (Markdown supported)",rows:4}),e.jsx(m,{type:"number",value:i.duration,onChange:e=>I(a,c,{duration:parseInt(e.target.value)||0}),placeholder:"Duration (minutes)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{size:"sm",onClick:()=>C(null),children:e.jsx(G,{className:"w-4 h-4"})}),e.jsx(h,{size:"sm",variant:"ghost",onClick:()=>C(null),children:e.jsx(M,{className:"w-4 h-4"})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx(Q,{className:"w-4 h-4 text-muted-foreground cursor-move"}),"video"===i.type?e.jsx(R,{className:"w-4 h-4"}):e.jsx(Y,{className:"w-4 h-4"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:i.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(j,{variant:"outline",className:"text-xs",children:i.type}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[i.duration,"m"]}),i.resources&&i.resources.length>0&&e.jsxs(j,{variant:"secondary",className:"text-xs",children:[i.resources.length," resources"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>U(a,c,"up"),disabled:0===c,children:"â†‘"}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>U(a,c,"down"),disabled:c===s.lectures.length-1,children:"â†“"}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>C({sectionIdx:a,lectureIdx:c}),children:e.jsx(O,{className:"w-3 h-3"})}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>S({sectionIdx:a,lectureIdx:c}),children:e.jsx(E,{className:"w-3 h-3"})}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>((e,s)=>{if(!confirm("Delete this lecture?"))return;const t=[...l];t[e].lectures=t[e].lectures.filter((e,l)=>l!==s),n(t)})(a,c),children:e.jsx(B,{className:"w-3 h-3 text-destructive"})})]})]}),i.resources&&i.resources.length>0&&e.jsx("div",{className:"mt-2 ml-6 space-y-1",children:i.resources.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between text-xs bg-background p-2 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-3 h-3"}),e.jsx("span",{children:s.title}),e.jsx(j,{variant:"outline",className:"text-xs",children:s.type})]}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>((e,s,t)=>{var i;const a=[...l];a[e].lectures[s].resources=(null==(i=a[e].lectures[s].resources)?void 0:i.filter((e,s)=>s!==t))||[],n(a)})(a,c,t),children:e.jsx(M,{className:"w-3 h-3"})})]},t))}),(null==w?void 0:w.sectionIdx)===a&&(null==w?void 0:w.lectureIdx)===c&&e.jsxs("div",{className:"mt-2 ml-6 space-y-2 p-2 border rounded",children:[e.jsx(m,{value:L.title,onChange:e=>q({...L,title:e.target.value}),placeholder:"Resource title",className:"text-sm"}),e.jsxs(g,{value:L.type,onValueChange:e=>q({...L,type:e}),children:[e.jsx(f,{className:"text-sm",children:e.jsx(N,{})}),e.jsxs(y,{children:[e.jsx(b,{value:"pdf",children:"PDF"}),e.jsx(b,{value:"document",children:"Document"}),e.jsx(b,{value:"link",children:"Link"}),e.jsx(b,{value:"video",children:"Video"}),e.jsx(b,{value:"image",children:"Image"}),e.jsx(b,{value:"other",children:"Other"})]})]}),e.jsx(m,{value:L.url,onChange:e=>q({...L,url:e.target.value}),placeholder:"Resource URL",className:"text-sm"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{size:"sm",onClick:()=>((e,s)=>{if(!L.title.trim()||!L.url.trim())return;const t=[...l],i={title:L.title,type:L.type,url:L.url,description:L.description};t[e].lectures[s].resources||(t[e].lectures[s].resources=[]),t[e].lectures[s].resources.push(i),n(t),q({title:"",type:"link",url:"",description:""}),S(null)})(a,c),disabled:!L.title.trim()||!L.url.trim(),children:"Add Resource"}),e.jsx(h,{size:"sm",variant:"ghost",onClick:()=>S(null),children:"Cancel"})]})]})]})})},c))}),e.jsx(t,{className:"ml-7 bg-muted/30",children:e.jsxs(r,{className:"p-3 space-y-2",children:[e.jsx("div",{className:"text-sm font-medium",children:"Add Lecture"}),e.jsx(m,{value:F.title,onChange:e=>k({...F,title:e.target.value}),placeholder:"Lecture title",className:"text-sm"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(g,{value:F.type,onValueChange:e=>k({...F,type:e}),children:[e.jsx(f,{className:"text-sm",children:e.jsx(N,{})}),e.jsxs(y,{children:[e.jsx(b,{value:"video",children:"Video"}),e.jsx(b,{value:"article",children:"Article"}),e.jsx(b,{value:"quiz",children:"Quiz"}),e.jsx(b,{value:"assignment",children:"Assignment"})]})]}),e.jsx(m,{type:"number",value:F.duration,onChange:e=>k({...F,duration:parseInt(e.target.value)||0}),placeholder:"Duration (min)",className:"text-sm"})]}),"video"===F.type&&e.jsx(m,{value:F.videoUrl,onChange:e=>k({...F,videoUrl:e.target.value}),placeholder:"Video URL (YouTube/Vimeo embed)",className:"text-sm"}),("article"===F.type||"assignment"===F.type)&&e.jsx(v,{value:F.content,onChange:e=>k({...F,content:e.target.value}),placeholder:"Content (Markdown supported)",rows:3,className:"text-sm"}),e.jsxs(h,{onClick:()=>(e=>{if(!F.title.trim())return;const s=[...l],t={title:F.title,type:F.type,content:F.content,videoUrl:F.videoUrl,duration:F.duration,order:s[e].lectures.length,resources:[]};s[e].lectures.push(t),n(s),k({title:"",type:"article",content:"",videoUrl:"",duration:0}),C(null)})(a),disabled:!F.title.trim(),className:"w-full gap-2",size:"sm",children:[e.jsx(E,{className:"w-4 h-4"}),"Add Lecture to Section"]})]})})]})]},a))}),0===l.length&&e.jsx(t,{children:e.jsxs(r,{className:"py-12 text-center text-muted-foreground",children:[e.jsx(Y,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No sections yet. Add your first section above to start building your curriculum."})]})})]})},de=()=>{const Q=async e=>{var s,l;try{const{id:s,createdAt:l,updatedAt:t,...i}=e,a=i.curriculum?JSON.parse(JSON.stringify(i.curriculum)):void 0,r={...i,title:i.title+" (Copy)",curriculum:a};await ee(r),G({title:"Lesson duplicated",description:`A copy of "${i.title}" has been created.`}),await rs()}catch(t){G({title:"Error duplicating lesson",description:(null==(l=null==(s=null==t?void 0:t.response)?void 0:s.data)?void 0:l.error)||(null==t?void 0:t.message)||"Failed to duplicate lesson",variant:"destructive"})}},{toast:G}=x(),[P,$]=l(),[R,Y]=s.useState(""),[W,de]=s.useState("all"),[oe,ue]=s.useState("grouped"),[he,xe]=s.useState([]),[me,je]=s.useState([]),[pe,ve]=s.useState(!0),[ge,fe]=s.useState(!1),[Ne,ye]=s.useState("lesson"),[be,Ce]=s.useState(null),[we,Se]=s.useState("all"),[ze,Te]=s.useState("all"),[Fe,ke]=s.useState(new Set),[Le,qe]=s.useState(!1),[Ae,Ie]=s.useState(!1),[De,Ue]=s.useState(!1),Ve="mindsta_lesson_draft",Ee="mindsta_curriculum_draft",[Qe,Ge]=s.useState({title:"",subtitle:"",description:"",content:"",subject:"",grade:"",term:"",difficulty:"",videoUrl:"",imageUrl:"",order:0,duration:30,price:0,whatYouWillLearn:[],requirements:[],targetAudience:[]}),[Me,Pe]=s.useState([]),[$e,Oe]=s.useState("simple"),[Be,Re]=s.useState({lessonId:"",title:"",description:"",passingScore:70,timeLimit:600}),[Ye,We]=s.useState(""),[Je,He]=s.useState(""),[_e,Ke]=s.useState(""),Xe=()=>({question:"",options:["","","",""],correctAnswer:-1,explanation:""}),[Ze,es]=s.useState([{question:"",options:["","","",""],correctAnswer:-1,explanation:""}]),[ss,ls]=s.useState(0),ts=e=>{const s=Array.isArray(e.options)&&4===e.options.length&&e.options.every(e=>e.trim()),l=e.correctAnswer>=0&&e.correctAnswer<4;return e.question.trim()&&e.explanation.trim()&&s&&l},is=Ze.filter(ts).length,as=10===Ze.length&&10===is;s.useEffect(()=>{rs()},[]),s.useEffect(()=>{const e=P.get("create");"lesson"!==e&&"quiz"!==e||(xs(e),$({}))},[P]),s.useEffect(()=>{if(ge&&"lesson"===Ne&&!be){const e=setInterval(()=>{(Qe.title||Qe.description||Qe.content||Me.length>0)&&ns()},12e4);return()=>clearInterval(e)}},[ge,Ne,be,Qe,Me]);const rs=async()=>{ve(!0);try{const[e,s]=await Promise.all([X(),le()]);xe(e),je(s)}catch(e){G({title:"Error",description:"Failed to fetch content",variant:"destructive"})}finally{ve(!1)}},ns=()=>{Ue(!0);try{const e={lessonForm:Qe,curriculum:Me,curriculumMode:$e,timestamp:(new Date).toISOString()};localStorage.setItem(Ve,JSON.stringify(e)),localStorage.setItem(Ee,JSON.stringify(Me)),G({title:"Progress Saved",description:"Your work has been saved. You can continue later."}),de(e=>e)}catch(e){G({title:"Error",description:"Failed to save progress",variant:"destructive"})}finally{Ue(!1)}},cs=()=>{try{const e=localStorage.getItem(Ve);if(e){const s=JSON.parse(e);return Ge(s.lessonForm),Pe(s.curriculum||[]),Oe(s.curriculumMode||"simple"),G({title:"Draft Loaded",description:`Restored from ${new Date(s.timestamp).toLocaleString()}`}),!0}return!1}catch(e){return!1}},ds=()=>{try{return null!==localStorage.getItem(Ve)}catch{return!1}},os=()=>{try{localStorage.removeItem(Ve),localStorage.removeItem(Ee)}catch(e){}},us=()=>{Ge({title:"",subtitle:"",description:"",content:"",subject:"",grade:"",term:"",difficulty:"",videoUrl:"",imageUrl:"",order:0,duration:30,price:0,whatYouWillLearn:[],requirements:[],targetAudience:[]}),Pe([]),Oe("simple")},hs=()=>{Re({lessonId:"",title:"",description:"",passingScore:70,timeLimit:600}),es([{question:"",options:["","","",""],correctAnswer:-1,explanation:""}]),ls(0),We(""),He(""),Ke("")},xs=e=>{if(ye(e),Ce(null),"lesson"===e)if(ds()){window.confirm("You have a saved draft. Do you want to continue from where you left off?")?cs():(us(),os())}else us();else hs();fe(!0)},ms=(e,s)=>{if(ye(s),Ce(e.id),"lesson"===s){const s=e,l={beginner:"easy",intermediate:"medium",advanced:"hard",easy:"easy",medium:"medium",hard:"hard"};Ge({title:s.title,subtitle:s.subtitle||"",description:s.description,content:s.content||"",subject:s.subject,grade:s.grade,term:s.term,difficulty:l[s.difficulty]||s.difficulty,videoUrl:s.videoUrl||"",imageUrl:s.imageUrl||"",order:s.order||0,duration:s.duration||30,price:s.price||1200,whatYouWillLearn:s.whatYouWillLearn||[],requirements:s.requirements||[],targetAudience:s.targetAudience||[]}),Pe(s.curriculum||[]),Oe(s.curriculum&&s.curriculum.length>0?"advanced":"simple")}else{const s=e,l=he.find(e=>e.id===s.lessonId);Re({lessonId:s.lessonId,title:s.title,description:s.description,passingScore:s.passingScore,timeLimit:s.timeLimit||600}),es((e=>{const s=[...e];for(;s.length<10;)s.push(Xe());return s.slice(0,10)})(s.questions||[])),ls(0),l&&(We(l.grade),He(l.term),Ke(l.subject))}fe(!0)},js=async()=>{var e,s;if("simple"===$e){if(!(Qe.title&&Qe.description&&Qe.content&&Qe.subject&&Qe.grade&&Qe.term&&Qe.difficulty))return void G({title:"Validation Error",description:"Please fill in all required fields (including term)",variant:"destructive"})}else{if(!(Qe.title&&Qe.description&&Qe.subject&&Qe.grade&&Qe.term&&Qe.difficulty))return void G({title:"Validation Error",description:"Please fill in all required fields",variant:"destructive"});if(0===Me.length)return void G({title:"Validation Error",description:"Please add at least one section to your curriculum",variant:"destructive"})}try{const e={easy:"beginner",medium:"intermediate",hard:"advanced"},s={...Qe,difficulty:e[Qe.difficulty]||Qe.difficulty,keywords:[],learningObjectives:[]};if("advanced"===$e){s.curriculum=Me;const e=Me.reduce((e,s)=>e+s.lectures.reduce((e,s)=>e+(s.duration||0),0),0);s.duration=e}be?(await Z(be,s),G({title:"Success",description:"Lesson updated successfully"})):(await ee(s),G({title:"Success",description:"Lesson created successfully"})),await rs(),fe(!1),us(),os()}catch(l){G({title:"Error",description:(null==(s=null==(e=null==l?void 0:l.response)?void 0:e.data)?void 0:s.error)||(null==l?void 0:l.message)||"Failed to save lesson",variant:"destructive"})}},ps=async()=>{if(!Be.lessonId||!Be.title||!Be.description)return void G({title:"Validation Error",description:"Please fill in all required fields",variant:"destructive"});const e=Ze.filter(e=>e.question.trim()&&e.options.every(e=>e.trim())&&e.explanation.trim());if(10===Ze.length)if(10===e.length)try{const s={...Be,questions:e};be?(await te(be,s),G({title:"Success",description:"Quiz updated successfully"})):(await ie(s),G({title:"Success",description:"Quiz created successfully"})),await rs(),fe(!1),hs()}catch(s){G({title:"Error",description:"Failed to save quiz",variant:"destructive"})}else G({title:"Validation Error",description:"Please complete all 10 questions (question, 4 options, explanation, choose correct)",variant:"destructive"});else G({title:"Validation Error",description:"Exam must contain exactly 10 questions",variant:"destructive"})},vs=async(e,s)=>{if(confirm(`Are you sure you want to delete this ${s}?`))try{"lesson"===s?await se(e):await ae(e),G({title:"Success",description:("lesson"===s?"Lesson":"Quiz")+" deleted successfully"}),await rs()}catch(l){G({title:"Error",description:`Failed to delete ${s}`,variant:"destructive"})}},gs=()=>{if(Ze.length>=10)return;if(!ts(Ze[ss]))return;const e=[...Ze,{question:"",options:["","","",""],correctAnswer:-1,explanation:""}];es(e),ls(e.length-1)},fs=e=>{if(e!==Ze.length-1)return;if(Ze.length<=1)return;const s=Ze.slice(0,-1);es(s),ls(s.length-1)},Ns=(e,s,l)=>{const t=[...Ze];t[e]={...t[e],[s]:l},es(t)},ys=(e,s,l)=>{const t=[...Ze];t[e].options[s]=l,es(t)},bs=[...he.map(e=>({...e,type:"lesson"})),...me.map(e=>({...e,type:"quiz"}))],Cs=bs.filter(e=>{var s;const l=e.title.toLowerCase().includes(R.toLowerCase())||"lesson"===e.type&&e.subject.toLowerCase().includes(R.toLowerCase())||"quiz"===e.type&&(null==(s=e.lessonTitle)?void 0:s.toLowerCase().includes(R.toLowerCase())),t="all"===W||e.type===W.replace("s",""),i="all"===we||"lesson"===e.type&&e.grade===we||"quiz"===e.type&&e.lessonGrade===we,a="all"===ze||"lesson"===e.type&&e.subject===ze||"quiz"===e.type&&e.lessonSubject===ze;return l&&t&&i&&a}),ws=Array.from(new Set(he.map(e=>e.subject))),Ss=Array.from(new Set(he.map(e=>e.grade))).sort(),zs=he.filter(e=>{const s=!Ye||e.grade===Ye,l=!Je||e.term===Je,t=!_e||e.subject===_e;return s&&l&&t}),Ts=Array.from(new Set(he.filter(e=>!(Ye&&e.grade!==Ye||Je&&e.term!==Je)).map(e=>e.subject))),Fs=["First Term","Second Term","Third Term"],ks={};he.filter(e=>{const s=e.title.toLowerCase().includes(R.toLowerCase())||e.subject.toLowerCase().includes(R.toLowerCase()),l="all"===we||e.grade===we,t="all"===ze||e.subject===ze;return s&&l&&t}).forEach(e=>{ks[e.grade]||(ks[e.grade]={});const s=e.term||"Unassigned";ks[e.grade][s]||(ks[e.grade][s]=[]),ks[e.grade][s].push(e)});const Ls=new Map(he.map(e=>[e.id,e])),qs={};me.filter(e=>{var s,l,t;null==(s=Ls.get(e.lessonId))||s.term;const i=e.lessonGrade||(null==(l=Ls.get(e.lessonId))?void 0:l.grade)||"",a=e.lessonSubject||(null==(t=Ls.get(e.lessonId))?void 0:t.subject)||"";return(e.title.toLowerCase().includes(R.toLowerCase())||(e.lessonTitle||"").toLowerCase().includes(R.toLowerCase()))&&("all"===we||i===we)&&("all"===ze||a===ze)}).forEach(e=>{const s=Ls.get(e.lessonId),l=(e.lessonGrade||(null==s?void 0:s.grade)||"").toString(),t=(null==s?void 0:s.term)||"Unassigned";l&&(qs[l]||(qs[l]={}),qs[l][t]||(qs[l][t]=[]),qs[l][t].push(e))});const As={lessons:he.length,quizzes:me.length,total:he.length+me.length};return e.jsxs(V,{children:[ge&&e.jsx("div",{className:"fixed top-0 left-0 right-0 bottom-0 z-50 bg-background overflow-auto",children:e.jsx("div",{className:"container mx-auto p-4 sm:p-6 max-w-4xl",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between sticky top-0 bg-background py-4 border-b z-10",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("h1",{className:"text-3xl font-bold text-foreground",children:[be?"Edit":"Create"," ","lesson"===Ne?"Lesson":"Quiz"]}),!be&&ds()&&"lesson"===Ne&&e.jsx(j,{variant:"secondary",className:"gap-1",children:"ðŸ’¾ Draft Saved"})]}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"lesson"===Ne?"Fill in the lesson details below":"Create a quiz for a lesson"}),!be&&"lesson"===Ne&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:'ðŸ’¡ Your progress is auto-saved every 2 minutes. Click "Save Progress" to save manually.'})]}),e.jsxs(h,{variant:"outline",onClick:()=>fe(!1),className:"gap-2",children:[e.jsx(M,{className:"w-4 h-4"}),"Back to Content"]})]}),"lesson"===Ne?e.jsxs(c,{value:$e,onValueChange:e=>Oe(e),className:"w-full",children:[e.jsxs(d,{className:"grid w-full grid-cols-2",children:[e.jsx(o,{value:"simple",children:"Simple Lesson"}),e.jsx(o,{value:"advanced",children:"Course with Curriculum"})]}),e.jsx(u,{value:"simple",className:"space-y-4 py-4",children:e.jsx(t,{children:e.jsxs(r,{className:"pt-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"title",children:"Title *"}),e.jsx(m,{id:"title",value:Qe.title,onChange:e=>Ge({...Qe,title:e.target.value}),placeholder:"Lesson title"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"subject",children:"Subject *"}),e.jsxs(g,{value:Qe.subject,onValueChange:e=>Ge({...Qe,subject:e}),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select subject"})}),e.jsxs(y,{children:[e.jsx(b,{value:"Mathematics",children:"Mathematics"}),e.jsx(b,{value:"English",children:"English"}),e.jsx(b,{value:"Science",children:"Science"}),e.jsx(b,{value:"Social Studies",children:"Social Studies"}),e.jsx(b,{value:"Arts & Crafts",children:"Arts & Crafts"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"grade",children:"Grade *"}),e.jsxs(g,{value:Qe.grade,onValueChange:e=>Ge({...Qe,grade:e}),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select grade"})}),e.jsx(y,{children:[1,2,3,4,5,6].map(s=>e.jsxs(b,{value:s.toString(),children:["Grade ",s]},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"term",children:"Term *"}),e.jsxs(g,{value:Qe.term,onValueChange:e=>Ge({...Qe,term:e}),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select term"})}),e.jsxs(y,{children:[e.jsx(b,{value:"First Term",children:"First Term"}),e.jsx(b,{value:"Second Term",children:"Second Term"}),e.jsx(b,{value:"Third Term",children:"Third Term"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"difficulty",children:"Difficulty *"}),e.jsxs(g,{value:Qe.difficulty,onValueChange:e=>Ge({...Qe,difficulty:e}),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select difficulty"})}),e.jsxs(y,{children:[e.jsx(b,{value:"easy",children:"Easy"}),e.jsx(b,{value:"medium",children:"Medium"}),e.jsx(b,{value:"hard",children:"Hard"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"duration",children:"Duration (min)"}),e.jsx(m,{id:"duration",type:"number",value:Qe.duration,onChange:e=>Ge({...Qe,duration:parseInt(e.target.value)||30})})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"price",children:"Price (â‚¦)"}),e.jsx(m,{id:"price",type:"number",min:"0",required:!0,value:Qe.price,onChange:e=>Ge({...Qe,price:parseInt(e.target.value)||0}),placeholder:"Enter price in Naira"})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"description",children:"Description *"}),e.jsx(v,{id:"description",value:Qe.description,onChange:e=>Ge({...Qe,description:e.target.value}),placeholder:"Brief description of the lesson",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"content",children:"Content * (Markdown supported)"}),e.jsx(v,{id:"content",value:Qe.content,onChange:e=>Ge({...Qe,content:e.target.value}),placeholder:"# Lesson Content\n\nWrite your lesson content here...",rows:12})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"videoUrl",children:"Video URL (Optional)"}),e.jsx(m,{id:"videoUrl",value:Qe.videoUrl,onChange:e=>Ge({...Qe,videoUrl:e.target.value}),placeholder:"https://youtube.com/embed/..."})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4",children:[e.jsx(h,{variant:"secondary",onClick:ns,disabled:De||null!==be,className:"gap-2",children:De?"Saving...":"ðŸ’¾ Save Progress"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{variant:"outline",onClick:()=>fe(!1),children:"Cancel"}),e.jsxs(h,{onClick:js,children:[be?"Update":"Create"," Lesson"]})]})]})]})})}),e.jsxs(u,{value:"advanced",className:"space-y-4 py-4",children:[e.jsxs(t,{children:[e.jsx(i,{children:e.jsx(a,{className:"text-base",children:"Basic Information"})}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"title-adv",children:"Course Title *"}),e.jsx(m,{id:"title-adv",value:Qe.title,onChange:e=>Ge({...Qe,title:e.target.value}),placeholder:"e.g., Complete Introduction to Algebra"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"subtitle",children:"Course Subtitle"}),e.jsx(m,{id:"subtitle",value:Qe.subtitle,onChange:e=>Ge({...Qe,subtitle:e.target.value}),placeholder:"Short tagline for your course"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"grade-adv",children:"Grade *"}),e.jsxs(g,{value:Qe.grade,onValueChange:e=>Ge({...Qe,grade:e}),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select grade"})}),e.jsx(y,{children:[1,2,3,4,5,6].map(s=>e.jsxs(b,{value:s.toString(),children:["Grade ",s]},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"term-adv",children:"Term *"}),e.jsxs(g,{value:Qe.term,onValueChange:e=>Ge({...Qe,term:e}),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select term"})}),e.jsxs(y,{children:[e.jsx(b,{value:"First Term",children:"First Term"}),e.jsx(b,{value:"Second Term",children:"Second Term"}),e.jsx(b,{value:"Third Term",children:"Third Term"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"subject-adv",children:"Subject *"}),e.jsxs(g,{value:Qe.subject,onValueChange:e=>Ge({...Qe,subject:e}),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select subject"})}),e.jsxs(y,{children:[e.jsx(b,{value:"Mathematics",children:"Mathematics"}),e.jsx(b,{value:"English",children:"English"}),e.jsx(b,{value:"Science",children:"Science"}),e.jsx(b,{value:"Social Studies",children:"Social Studies"}),e.jsx(b,{value:"Arts & Crafts",children:"Arts & Crafts"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"difficulty-adv",children:"Difficulty *"}),e.jsxs(g,{value:Qe.difficulty,onValueChange:e=>Ge({...Qe,difficulty:e}),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select difficulty"})}),e.jsxs(y,{children:[e.jsx(b,{value:"easy",children:"Easy"}),e.jsx(b,{value:"medium",children:"Medium"}),e.jsx(b,{value:"hard",children:"Hard"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"description-adv",children:"Course Description *"}),e.jsx(v,{id:"description-adv",value:Qe.description,onChange:e=>Ge({...Qe,description:e.target.value}),placeholder:"Comprehensive description of what this course covers...",rows:4})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"imageUrl",children:"Course Thumbnail URL"}),e.jsx(m,{id:"imageUrl",value:Qe.imageUrl,onChange:e=>Ge({...Qe,imageUrl:e.target.value}),placeholder:"https://..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"price-adv",children:"Course Price (â‚¦) *"}),e.jsx(m,{id:"price-adv",type:"number",min:"0",required:!0,value:Qe.price,onChange:e=>Ge({...Qe,price:parseInt(e.target.value)||0}),placeholder:"Enter price in Naira"})]})]})]}),e.jsxs(t,{children:[e.jsxs(i,{children:[e.jsx(a,{className:"text-base",children:"Curriculum"}),e.jsx(n,{children:"Build your course structure with sections and lectures"})]}),e.jsx(r,{children:e.jsx(ce,{curriculum:Me,onChange:Pe})})]}),e.jsx(t,{children:e.jsx(r,{className:"pt-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(h,{variant:"secondary",onClick:ns,disabled:De||null!==be,className:"gap-2",children:De?"Saving...":"ðŸ’¾ Save Progress"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{variant:"outline",onClick:()=>fe(!1),children:"Cancel"}),e.jsxs(h,{onClick:js,children:[be?"Update":"Create"," Course"]})]})]})})})]})]}):e.jsx(t,{children:e.jsxs(r,{className:"pt-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"quizGrade",children:"Grade *"}),e.jsxs(g,{value:Ye,onValueChange:e=>{We(e),He(""),Ke(""),Re({...Be,lessonId:""})},children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select grade"})}),e.jsx(y,{children:Ss.map(s=>e.jsxs(b,{value:s.toString(),children:["Grade ",s]},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"quizTerm",children:"Term *"}),e.jsxs(g,{value:Je,onValueChange:e=>{He(e),Ke(""),Re({...Be,lessonId:""})},disabled:!Ye,children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select term"})}),e.jsxs(y,{children:[e.jsx(b,{value:"First Term",children:"First Term"}),e.jsx(b,{value:"Second Term",children:"Second Term"}),e.jsx(b,{value:"Third Term",children:"Third Term"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"quizSubject",children:"Subject *"}),e.jsxs(g,{value:_e,onValueChange:e=>{Ke(e),Re({...Be,lessonId:""})},disabled:!Ye||!Je,children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select subject"})}),e.jsx(y,{children:0===Ts.length?e.jsx(b,{value:"none",disabled:!0,children:"No subjects available"}):Ts.map(s=>e.jsx(b,{value:s,children:s},s))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"lessonId",children:"Lesson *"}),e.jsxs(g,{value:Be.lessonId,onValueChange:e=>Re({...Be,lessonId:e}),disabled:!Ye||!Je||!_e,children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select lesson"})}),e.jsx(y,{children:0===zs.length?e.jsx(b,{value:"none",disabled:!0,children:Ye&&Je&&_e?"No lessons available for selected filters":"Select grade, term, and subject first"}):zs.map(s=>e.jsx(b,{value:s.id,children:s.title},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"quizTitle",children:"Quiz Title *"}),e.jsx(m,{id:"quizTitle",value:Be.title,onChange:e=>Re({...Be,title:e.target.value}),placeholder:"Quiz title"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"quizDescription",children:"Description *"}),e.jsx(v,{id:"quizDescription",value:Be.description,onChange:e=>Re({...Be,description:e.target.value}),placeholder:"Quiz description",rows:2})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"passingScore",children:"Passing Score (%)"}),e.jsx(m,{id:"passingScore",type:"number",value:Be.passingScore,onChange:e=>Re({...Be,passingScore:parseInt(e.target.value)||70})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Time Limit"}),e.jsx(m,{value:"10 minutes (fixed)",disabled:!0})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(p,{children:"Questions"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Complete each question to unlock the next. Exactly 10 questions are required."})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[is,"/10 complete"]})]}),e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:Array.from({length:10}).map((s,l)=>{const t=l<Ze.length,i=t&&ts(Ze[l]),a=l===ss;return e.jsx("button",{type:"button",disabled:!t,onClick:()=>t&&ls(l),className:"w-8 h-8 rounded-full border text-xs font-medium flex items-center justify-center transition "+(a?"border-blue-600 text-blue-600":i?"bg-green-500 text-white border-green-500":t?"border-muted-foreground/30 text-foreground":"border-muted text-muted-foreground opacity-50"),title:t?i?"Complete":"Incomplete":"Locked",children:l+1},l)})}),e.jsx("div",{className:"w-full h-2 rounded bg-muted overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-600 transition-all",style:{width:is/10*100+"%"}})}),(()=>{const s=ss,l=Ze[s];return e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(p,{className:"text-base",children:["Question ",s+1]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(h,{type:"button",variant:"ghost",size:"sm",onClick:()=>fs(s),disabled:Ze.length<=1||s!==Ze.length-1,children:e.jsx(M,{className:"w-4 h-4 text-destructive"})})})]}),e.jsx(m,{value:l.question,onChange:e=>Ns(s,"question",e.target.value),placeholder:"Enter question"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:l.options.map((t,i)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{value:t,onChange:e=>ys(s,i,e.target.value),placeholder:`Option ${i+1}`}),e.jsx("input",{type:"radio",name:`correct-${s}`,checked:l.correctAnswer===i,onChange:()=>Ns(s,"correctAnswer",i),className:"w-4 h-4"})]},i))}),e.jsx(v,{value:l.explanation,onChange:e=>Ns(s,"explanation",e.target.value),placeholder:"Explanation for the correct answer",rows:2}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>ls(e=>Math.max(0,e-1)),disabled:0===ss,children:"Previous"}),ss===Ze.length-1?Ze.length<10?e.jsx(h,{type:"button",onClick:gs,disabled:!ts(l),children:"Add Next Question"}):e.jsx(h,{type:"button",disabled:!as,children:"All Questions Added"}):e.jsx(h,{type:"button",onClick:()=>ls(e=>Math.min(Ze.length-1,e+1)),disabled:!ts(Ze[ss]),children:"Next"})]})]})})})()]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(h,{variant:"outline",onClick:()=>fe(!1),children:"Cancel"}),e.jsxs(h,{onClick:ps,disabled:!(as&&Be.lessonId&&Be.title&&Be.description),children:[be?"Update":"Create"," Quiz"]})]})]})})]})})}),!ge&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Content Management"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Create and manage lessons and quizzes"})]}),e.jsxs("div",{className:"flex gap-2",children:[ds()&&e.jsxs(h,{onClick:()=>{cs(),ye("lesson"),Ce(null),fe(!0)},variant:"secondary",className:"gap-2",children:[e.jsx(O,{className:"w-4 h-4"}),"Continue Draft"]}),e.jsxs(h,{onClick:()=>xs("lesson"),className:"gap-2",children:[e.jsx(E,{className:"w-4 h-4"}),"Create Lesson"]}),e.jsxs(h,{onClick:()=>xs("quiz"),variant:"outline",className:"gap-2",children:[e.jsx(E,{className:"w-4 h-4"}),"Create Quiz"]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(t,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(a,{className:"text-sm font-medium",children:"Total Lessons"}),e.jsx(J,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold",children:As.lessons}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Educational content"})]})]}),e.jsxs(t,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(a,{className:"text-sm font-medium",children:"Total Quizzes"}),e.jsx(H,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold",children:As.quizzes}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Assessment tools"})]})]}),e.jsxs(t,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(a,{className:"text-sm font-medium",children:"Total Content"}),e.jsx(J,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold",children:As.total}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"All items"})]})]})]}),e.jsx(t,{children:e.jsx(i,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 w-full",children:[e.jsx(_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(m,{placeholder:"Search content...",value:R,onChange:e=>Y(e.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsxs(g,{value:we,onValueChange:Se,children:[e.jsx(f,{className:"w-full sm:w-[140px]",children:e.jsx(N,{placeholder:"Grade"})}),e.jsxs(y,{children:[e.jsx(b,{value:"all",children:"All Grades"}),Ss.map(s=>e.jsxs(b,{value:s,children:["Grade ",s]},s))]})]}),e.jsxs(g,{value:ze,onValueChange:Te,children:[e.jsx(f,{className:"w-full sm:w-[160px]",children:e.jsx(N,{placeholder:"Subject"})}),e.jsxs(y,{children:[e.jsx(b,{value:"all",children:"All Subjects"}),ws.map(s=>e.jsx(b,{value:s,children:s},s))]})]}),e.jsxs(g,{value:oe,onValueChange:e=>ue(e),children:[e.jsx(f,{className:"w-full sm:w-[160px]",children:e.jsx(N,{placeholder:"View"})}),e.jsxs(y,{children:[e.jsx(b,{value:"grouped",children:"Grouped by Grade/Term"}),e.jsx(b,{value:"list",children:"List View"})]})]})]})]})})}),e.jsxs(t,{children:[e.jsxs(i,{children:[e.jsx(a,{children:"grouped"===oe?"Content by Grade and Term":"Content Library"}),e.jsx(n,{children:"grouped"===oe?"Browse lessons and quizzes organized by grade and academic term":`Browse and manage all educational content (${Cs.length} items)`})]}),e.jsxs(r,{children:[e.jsx(re,{children:Fe.size>0&&e.jsxs(ne.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-4 p-4 bg-indigo-50 dark:bg-indigo-950/30 border border-indigo-200 dark:border-indigo-800 rounded-lg flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-500 text-white flex items-center justify-center font-semibold text-sm",children:Fe.size}),e.jsxs("span",{className:"font-medium",children:[Fe.size," item",1!==Fe.size?"s":""," selected"]})]}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>{ke(new Set)},className:"text-muted-foreground",children:"Clear"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>{const e=Cs.map(e=>e.id);ke(new Set(e))},className:"text-indigo-600 dark:text-indigo-400",children:"Select All Visible"}),e.jsxs(h,{variant:"destructive",size:"sm",onClick:()=>qe(!0),className:"gap-2",disabled:Ae,children:[e.jsx(B,{className:"w-4 h-4"}),"Delete Selected"]})]})]})}),e.jsxs(c,{value:W,onValueChange:de,children:[e.jsxs(d,{className:"mb-4",children:[e.jsxs(o,{value:"all",children:["All Content (",As.total,")"]}),e.jsxs(o,{value:"lessons",children:["Lessons (",As.lessons,")"]}),e.jsxs(o,{value:"quizzes",children:["Quizzes (",As.quizzes,")"]}),e.jsxs(o,{value:"drafts",children:["Drafts ",ds()&&e.jsx(j,{variant:"secondary",className:"ml-2",children:"1"})]})]}),e.jsx(u,{value:"drafts",children:ds()?e.jsxs(t,{children:[e.jsxs(i,{children:[e.jsx(a,{children:"Saved Drafts"}),e.jsx(n,{children:"Resume your work on unfinished lessons"})]}),e.jsx(r,{children:(()=>{try{const s=localStorage.getItem(Ve);if(!s)return null;const l=JSON.parse(s),t=new Date(l.timestamp);return e.jsx("div",{className:"border rounded-lg p-4 hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(j,{variant:"outline",className:"gap-1",children:[e.jsx(J,{className:"w-3 h-3"}),"Lesson Draft"]}),e.jsx(j,{variant:"secondary",children:"advanced"===l.curriculumMode?"Advanced Course":"Simple Lesson"})]}),e.jsx("h3",{className:"font-semibold text-lg mb-1",children:l.lessonForm.title||"Untitled Lesson"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:l.lessonForm.description||"No description"}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-muted-foreground",children:[l.lessonForm.subject&&e.jsxs("span",{className:"flex items-center gap-1",children:["ðŸ“š ",l.lessonForm.subject]}),l.lessonForm.grade&&e.jsxs("span",{className:"flex items-center gap-1",children:["ðŸŽ“ Grade ",l.lessonForm.grade]}),l.lessonForm.term&&e.jsxs("span",{className:"flex items-center gap-1",children:["ðŸ“… ",l.lessonForm.term]}),l.curriculum&&l.curriculum.length>0&&e.jsxs("span",{className:"flex items-center gap-1",children:["ðŸ“‘ ",l.curriculum.length," section",1!==l.curriculum.length?"s":""]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-3",children:["ðŸ’¾ Saved on ",t.toLocaleDateString()," at ",t.toLocaleTimeString()]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(h,{size:"sm",onClick:()=>{cs(),ye("lesson"),Ce(null),fe(!0)},className:"gap-2",children:[e.jsx(O,{className:"w-4 h-4"}),"Continue Editing"]}),e.jsxs(h,{size:"sm",variant:"outline",onClick:()=>{window.confirm("Are you sure you want to delete this draft? This action cannot be undone.")&&(os(),G({title:"Draft Deleted",description:"The saved draft has been removed."}),de("all"))},className:"gap-2 text-destructive hover:text-destructive",children:[e.jsx(B,{className:"w-4 h-4"}),"Delete Draft"]})]})]})})}catch(s){return e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{children:"Error loading draft. The draft may be corrupted."}),e.jsx(h,{variant:"outline",className:"mt-4",onClick:()=>{os(),G({title:"Draft Cleared",description:"The corrupted draft has been removed."})},children:"Clear Draft"})]})}})()})]}):e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-muted flex items-center justify-center",children:e.jsx(J,{className:"w-8 h-8 opacity-50"})}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"No Drafts"}),e.jsx("p",{className:"text-sm mb-4",children:'You don\'t have any saved drafts yet. Start creating a lesson and use "Save Progress" to save your work.'}),e.jsxs(h,{variant:"outline",onClick:()=>xs("lesson"),className:"gap-2",children:[e.jsx(E,{className:"w-4 h-4"}),"Create New Lesson"]})]})}),"list"===oe?e.jsx(u,{value:W,children:pe?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:e.jsx("p",{children:"Loading content..."})}):0===Cs.length?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(J,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No content found"}),e.jsx(h,{variant:"outline",className:"mt-4",onClick:()=>xs("lesson"),children:"Create Your First Lesson"})]}):e.jsx("div",{className:"rounded-md border",children:e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(q,{children:[e.jsx(A,{children:"Type"}),e.jsx(A,{children:"Title"}),e.jsx(A,{children:"Subject/Lesson"}),e.jsx(A,{children:"Grade"}),e.jsx(A,{children:"Details"}),e.jsx(A,{className:"text-right",children:"Actions"})]})}),e.jsx(I,{children:Cs.map(s=>{var l,t;return e.jsxs(q,{children:[e.jsx(D,{children:e.jsx(j,{variant:"outline",className:"gap-1",children:"lesson"===s.type?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"w-3 h-3"})," Lesson"]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"w-3 h-3"})," Quiz"]})})}),e.jsx(D,{className:"font-medium",children:s.title}),e.jsx(D,{children:"lesson"===s.type?s.subject:s.lessonTitle||"N/A"}),e.jsxs(D,{children:["Grade ","lesson"===s.type?s.grade:s.lessonGrade||"N/A"]}),e.jsx(D,{children:"lesson"===s.type?e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{variant:"secondary",children:s.difficulty}),e.jsx(j,{variant:"outline",children:s.term||"Unassigned"}),s.videoUrl&&e.jsx(j,{variant:"outline",children:"Video"})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(j,{variant:"secondary",children:[(null==(l=s.questions)?void 0:l.length)||0," Questions"]}),e.jsxs(j,{variant:"outline",children:[s.passingScore,"% Pass"]}),e.jsx(j,{variant:"outline",children:(null==(t=Ls.get(s.lessonId))?void 0:t.term)||"Unassigned"})]})}),e.jsx(D,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>ms(s,s.type),children:e.jsx(O,{className:"w-4 h-4"})}),"lesson"===s.type&&e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>Q(s),children:e.jsx("span",{title:"Duplicate",children:"ðŸ“„"})}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>vs(s.id,s.type),children:e.jsx(B,{className:"w-4 h-4 text-destructive"})})]})})]},s.id)})})]})})}):e.jsx(u,{value:W,children:pe?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:e.jsx("p",{children:"Loading content..."})}):e.jsx("div",{className:"space-y-6",children:("all"===we?Ss:[we]).map(s=>{const l=bs.filter(e=>"lesson"===e.type?e.grade===s:e.lessonGrade===s).length;return e.jsxs(t,{className:"border-muted",children:[e.jsx(i,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(a,{children:["Grade ",s]}),e.jsx(n,{children:"quizzes"===W?"Quizzes grouped by academic term":"Lessons grouped by academic term"})]}),l>0&&e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>(async e=>{const s=bs.filter(s=>"lesson"===s.type?s.grade===e:s.lessonGrade===e);if(0===s.length)return void G({title:"No items to delete",description:`Grade ${e} has no content`,variant:"destructive"});const l=new Set(s.map(e=>e.id));ke(l),qe(!0)})(s),className:"gap-2 text-destructive hover:text-destructive hover:bg-destructive/10",children:[e.jsx(B,{className:"w-4 h-4"}),"Delete All (",l,")"]})]})}),e.jsx(r,{children:e.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:Fs.map(l=>{var c,d;const o=(null==(c=ks[s])?void 0:c[l])||[],u=(null==(d=qs[s])?void 0:d[l])||[],x="quizzes"===W?u:"lessons"===W?o:[...o,...u];return e.jsxs(t,{className:"",children:[e.jsxs(i,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(a,{className:"text-base",children:l}),e.jsx(j,{variant:"secondary",children:x.length})]}),e.jsx(n,{children:"quizzes"===W?"Quizzes":"lessons"===W?"Lessons":"Lessons & Quizzes"})]}),e.jsx(r,{children:0===x.length?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No content"}):e.jsx("div",{className:"space-y-3",children:x.map(s=>{var l;const t=Fe.has(s.id);return e.jsxs(ne.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,x:-20},className:"flex items-start gap-3 border rounded-md p-3 transition-colors "+(t?"border-indigo-500 bg-indigo-50 dark:bg-indigo-950/20":"hover:border-gray-300"),children:[e.jsx(U,{checked:t,onCheckedChange:()=>(e=>{const s=new Set(Fe);s.has(e)?s.delete(e):s.add(e),ke(s)})(s.id),className:"mt-1"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{variant:"outline",className:"gap-1",children:"lesson"===("type"in s?s.type:s.questions?"quiz":"lesson")?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"w-3 h-3"})," Lesson"]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"w-3 h-3"})," Quiz"]})}),e.jsx("span",{className:"font-medium truncate max-w-[20rem]",children:s.title})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1 truncate max-w-[24rem]",children:"quizzes"===W?e.jsxs(e.Fragment,{children:["Lesson: ",s.lessonTitle||"N/A"," â€¢ ",(null==(l=s.questions)?void 0:l.length)||0," questions â€¢ Pass ",s.passingScore,"%"]}):e.jsxs(e.Fragment,{children:["Subject: ",s.subject," â€¢ Difficulty: ",s.difficulty]})})]}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>ms(s,"quizzes"===W?"quiz":"lesson"),children:e.jsx(O,{className:"w-4 h-4"})}),("lessons"===W||"all"===W)&&"lesson"===s.type&&e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>Q(s),children:e.jsx("span",{title:"Duplicate",children:"ðŸ“„"})}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>vs(s.id,"quizzes"===W?"quiz":"lesson"),children:e.jsx(B,{className:"w-4 h-4 text-destructive"})})]})]},s.id)})})})]},`${s}-${l}`)})})})]},s)})})})]})]})]}),e.jsx(C,{open:ge,onOpenChange:fe,children:e.jsxs(w,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(S,{children:[e.jsxs(z,{children:[be?"Edit":"Create"," ","lesson"===Ne?"Lesson":"Quiz"]}),e.jsx(T,{children:"lesson"===Ne?"Fill in the lesson details below":"Create a quiz for a lesson"})]}),"lesson"===Ne?e.jsxs(c,{value:$e,onValueChange:e=>Oe(e),className:"w-full",children:[e.jsxs(d,{className:"grid w-full grid-cols-2",children:[e.jsx(o,{value:"simple",children:"Simple Lesson"}),e.jsx(o,{value:"advanced",children:"Course with Curriculum"})]}),e.jsxs(u,{value:"simple",className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"title",children:"Title *"}),e.jsx(m,{id:"title",value:Qe.title,onChange:e=>Ge({...Qe,title:e.target.value}),placeholder:"Lesson title"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"subject",children:"Subject *"}),e.jsxs(g,{value:Qe.subject,onValueChange:e=>Ge({...Qe,subject:e}),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select subject"})}),e.jsxs(y,{children:[e.jsx(b,{value:"Mathematics",children:"Mathematics"}),e.jsx(b,{value:"English",children:"English"}),e.jsx(b,{value:"Science",children:"Science"}),e.jsx(b,{value:"Social Studies",children:"Social Studies"}),e.jsx(b,{value:"Arts & Crafts",children:"Arts & Crafts"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"grade",children:"Grade *"}),e.jsxs(g,{value:Qe.grade,onValueChange:e=>Ge({...Qe,grade:e}),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select grade"})}),e.jsx(y,{children:[1,2,3,4,5,6].map(s=>e.jsxs(b,{value:s.toString(),children:["Grade ",s]},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"term",children:"Term *"}),e.jsxs(g,{value:Qe.term,onValueChange:e=>Ge({...Qe,term:e}),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select term"})}),e.jsxs(y,{children:[e.jsx(b,{value:"First Term",children:"First Term"}),e.jsx(b,{value:"Second Term",children:"Second Term"}),e.jsx(b,{value:"Third Term",children:"Third Term"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"difficulty",children:"Difficulty *"}),e.jsxs(g,{value:Qe.difficulty,onValueChange:e=>Ge({...Qe,difficulty:e}),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select difficulty"})}),e.jsxs(y,{children:[e.jsx(b,{value:"easy",children:"Easy"}),e.jsx(b,{value:"medium",children:"Medium"}),e.jsx(b,{value:"hard",children:"Hard"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"duration",children:"Duration (min)"}),e.jsx(m,{id:"duration",type:"number",value:Qe.duration,onChange:e=>Ge({...Qe,duration:parseInt(e.target.value)||30})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"price",children:"Price (â‚¦)"}),e.jsx(m,{id:"price",type:"number",min:"0",required:!0,value:Qe.price,onChange:e=>Ge({...Qe,price:parseInt(e.target.value)||0}),placeholder:"Enter price in Naira"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"description",children:"Description *"}),e.jsx(v,{id:"description",value:Qe.description,onChange:e=>Ge({...Qe,description:e.target.value}),placeholder:"Brief description of the lesson",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"content",children:"Content * (Markdown supported)"}),e.jsx(v,{id:"content",value:Qe.content,onChange:e=>Ge({...Qe,content:e.target.value}),placeholder:"# Lesson Content\n\nWrite your lesson content here...",rows:8})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"videoUrl",children:"Video URL (Optional)"}),e.jsx(m,{id:"videoUrl",value:Qe.videoUrl,onChange:e=>Ge({...Qe,videoUrl:e.target.value}),placeholder:"https://youtube.com/embed/..."})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(h,{variant:"outline",onClick:()=>fe(!1),children:"Cancel"}),e.jsxs(h,{onClick:js,children:[be?"Update":"Create"," Lesson"]})]})]}),e.jsxs(u,{value:"advanced",className:"space-y-4 py-4",children:[e.jsxs(t,{children:[e.jsx(i,{children:e.jsx(a,{className:"text-base",children:"Basic Information"})}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"title-adv",children:"Course Title *"}),e.jsx(m,{id:"title-adv",value:Qe.title,onChange:e=>Ge({...Qe,title:e.target.value}),placeholder:"e.g., Complete Introduction to Algebra"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"subtitle",children:"Course Subtitle"}),e.jsx(m,{id:"subtitle",value:Qe.subtitle,onChange:e=>Ge({...Qe,subtitle:e.target.value}),placeholder:"Short tagline for your course"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"grade-adv",children:"Grade *"}),e.jsxs(g,{value:Qe.grade,onValueChange:e=>Ge({...Qe,grade:e}),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select grade"})}),e.jsx(y,{children:[1,2,3,4,5,6].map(s=>e.jsxs(b,{value:s.toString(),children:["Grade ",s]},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"term-adv",children:"Term *"}),e.jsxs(g,{value:Qe.term,onValueChange:e=>Ge({...Qe,term:e}),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select term"})}),e.jsxs(y,{children:[e.jsx(b,{value:"First Term",children:"First Term"}),e.jsx(b,{value:"Second Term",children:"Second Term"}),e.jsx(b,{value:"Third Term",children:"Third Term"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"subject-adv",children:"Subject *"}),e.jsxs(g,{value:Qe.subject,onValueChange:e=>Ge({...Qe,subject:e}),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select subject"})}),e.jsxs(y,{children:[e.jsx(b,{value:"Mathematics",children:"Mathematics"}),e.jsx(b,{value:"English",children:"English"}),e.jsx(b,{value:"Science",children:"Science"}),e.jsx(b,{value:"Social Studies",children:"Social Studies"}),e.jsx(b,{value:"Arts & Crafts",children:"Arts & Crafts"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"difficulty-adv",children:"Difficulty *"}),e.jsxs(g,{value:Qe.difficulty,onValueChange:e=>Ge({...Qe,difficulty:e}),children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select difficulty"})}),e.jsxs(y,{children:[e.jsx(b,{value:"easy",children:"Easy"}),e.jsx(b,{value:"medium",children:"Medium"}),e.jsx(b,{value:"hard",children:"Hard"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"description-adv",children:"Course Description *"}),e.jsx(v,{id:"description-adv",value:Qe.description,onChange:e=>Ge({...Qe,description:e.target.value}),placeholder:"Comprehensive description of what this course covers...",rows:4})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"imageUrl",children:"Course Thumbnail URL"}),e.jsx(m,{id:"imageUrl",value:Qe.imageUrl,onChange:e=>Ge({...Qe,imageUrl:e.target.value}),placeholder:"https://..."})]})]})]}),e.jsxs(t,{children:[e.jsxs(i,{children:[e.jsx(a,{className:"text-base",children:"Curriculum "}),e.jsx(n,{children:"Build your course structure with sections and lectures"})]}),e.jsx(r,{children:e.jsx(ce,{curriculum:Me,onChange:Pe})})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(h,{variant:"outline",onClick:()=>fe(!1),children:"Cancel"}),e.jsxs(h,{onClick:js,children:[be?"Update":"Create"," Course"]})]})]})]}):e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"quizGrade",children:"Grade *"}),e.jsxs(g,{value:Ye,onValueChange:e=>{We(e),He(""),Ke(""),Re({...Be,lessonId:""})},children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select grade"})}),e.jsx(y,{children:Ss.map(s=>e.jsxs(b,{value:s.toString(),children:["Grade ",s]},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"quizTerm",children:"Term *"}),e.jsxs(g,{value:Je,onValueChange:e=>{He(e),Ke(""),Re({...Be,lessonId:""})},disabled:!Ye,children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select term"})}),e.jsxs(y,{children:[e.jsx(b,{value:"First Term",children:"First Term"}),e.jsx(b,{value:"Second Term",children:"Second Term"}),e.jsx(b,{value:"Third Term",children:"Third Term"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"quizSubject",children:"Subject *"}),e.jsxs(g,{value:_e,onValueChange:e=>{Ke(e),Re({...Be,lessonId:""})},disabled:!Ye||!Je,children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select subject"})}),e.jsx(y,{children:0===Ts.length?e.jsx(b,{value:"none",disabled:!0,children:"No subjects available"}):Ts.map(s=>e.jsx(b,{value:s,children:s},s))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"lessonId",children:"Lesson *"}),e.jsxs(g,{value:Be.lessonId,onValueChange:e=>Re({...Be,lessonId:e}),disabled:!Ye||!Je||!_e,children:[e.jsx(f,{children:e.jsx(N,{placeholder:"Select lesson"})}),e.jsx(y,{children:0===zs.length?e.jsx(b,{value:"none",disabled:!0,children:Ye&&Je&&_e?"No lessons available for selected filters":"Select grade, term, and subject first"}):zs.map(s=>e.jsx(b,{value:s.id,children:s.title},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"quizTitle",children:"Quiz Title *"}),e.jsx(m,{id:"quizTitle",value:Be.title,onChange:e=>Re({...Be,title:e.target.value}),placeholder:"Quiz title"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"quizDescription",children:"Description *"}),e.jsx(v,{id:"quizDescription",value:Be.description,onChange:e=>Re({...Be,description:e.target.value}),placeholder:"Quiz description",rows:2})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"passingScore",children:"Passing Score (%)"}),e.jsx(m,{id:"passingScore",type:"number",value:Be.passingScore,onChange:e=>Re({...Be,passingScore:parseInt(e.target.value)||70})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Time Limit"}),e.jsx(m,{value:"10 minutes (fixed)",disabled:!0})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(p,{children:"Questions"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Complete each question to unlock the next. Exactly 10 questions are required."})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[is,"/10 complete"]})]}),e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:Array.from({length:10}).map((s,l)=>{const t=l<Ze.length,i=t&&ts(Ze[l]),a=l===ss;return e.jsx("button",{type:"button",disabled:!t,onClick:()=>t&&ls(l),className:"w-8 h-8 rounded-full border text-xs font-medium flex items-center justify-center transition "+(a?"border-blue-600 text-blue-600":i?"bg-green-500 text-white border-green-500":t?"border-muted-foreground/30 text-foreground":"border-muted text-muted-foreground opacity-50"),title:t?i?"Complete":"Incomplete":"Locked",children:l+1},l)})}),e.jsx("div",{className:"w-full h-2 rounded bg-muted overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-600 transition-all",style:{width:is/10*100+"%"}})}),(()=>{const s=ss,l=Ze[s];return e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(p,{className:"text-base",children:["Question ",s+1]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(h,{type:"button",variant:"ghost",size:"sm",onClick:()=>fs(s),disabled:Ze.length<=1||s!==Ze.length-1,children:e.jsx(M,{className:"w-4 h-4 text-destructive"})})})]}),e.jsx(m,{value:l.question,onChange:e=>Ns(s,"question",e.target.value),placeholder:"Enter question"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:l.options.map((t,i)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{value:t,onChange:e=>ys(s,i,e.target.value),placeholder:`Option ${i+1}`}),e.jsx("input",{type:"radio",name:`correct-${s}`,checked:l.correctAnswer===i,onChange:()=>Ns(s,"correctAnswer",i),className:"w-4 h-4"})]},i))}),e.jsx(v,{value:l.explanation,onChange:e=>Ns(s,"explanation",e.target.value),placeholder:"Explanation for the correct answer",rows:2}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>ls(e=>Math.max(0,e-1)),disabled:0===ss,children:"Previous"}),ss===Ze.length-1?Ze.length<10?e.jsx(h,{type:"button",onClick:gs,disabled:!ts(l),children:"Add Next Question"}):e.jsx(h,{type:"button",disabled:!as,onClick:()=>{},children:"All Questions Added"}):e.jsx(h,{type:"button",onClick:()=>ls(e=>Math.min(Ze.length-1,e+1)),disabled:!ts(Ze[ss]),children:"Next"})]})]})})})()]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(h,{variant:"outline",onClick:()=>fe(!1),children:"Cancel"}),e.jsxs(h,{onClick:ps,disabled:!(as&&Be.lessonId&&Be.title&&Be.description),children:[be?"Update":"Create"," Quiz"]})]})]})]})}),e.jsx(C,{open:Le,onOpenChange:qe,children:e.jsxs(w,{className:"sm:max-w-[425px]",children:[e.jsxs(S,{children:[e.jsxs(z,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-destructive/10 flex items-center justify-center",children:e.jsx(K,{className:"w-5 h-5 text-destructive"})}),"Confirm Bulk Delete"]}),e.jsxs(T,{children:["Are you sure you want to delete ",Fe.size," selected item",1!==Fe.size?"s":"","? This action cannot be undone."]})]}),e.jsx("div",{className:"py-4",children:e.jsxs("div",{className:"rounded-lg bg-muted p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Items to be deleted:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-destructive text-white flex items-center justify-center font-semibold text-sm",children:Fe.size}),e.jsxs("span",{className:"font-medium",children:[Fe.size," content item",1!==Fe.size?"s":""]})]})]})}),e.jsxs(F,{children:[e.jsx(h,{variant:"outline",onClick:()=>qe(!1),disabled:Ae,children:"Cancel"}),e.jsx(h,{variant:"destructive",onClick:async()=>{if(0!==Fe.size){Ie(!0);try{const e=Array.from(Fe).map(async e=>{try{const s=me.some(s=>s.id===e),l=he.some(s=>s.id===e);if(s){const s=await ae(e);if(!s)throw new Error(`Failed to delete quiz ${e}`);return s}if(l){const s=await se(e);if(!s)throw new Error(`Failed to delete lesson ${e}`);return s}throw new Error(`Item ${e} not found in lessons or quizzes`)}catch(s){throw s}}),s=await Promise.allSettled(e),l=s.filter(e=>"rejected"===e.status),t=s.filter(e=>"fulfilled"===e.status);l.length>0?G({title:"Partial Success",description:`Deleted ${t.length} items, but ${l.length} failed`,variant:"destructive"}):G({title:"Success",description:`Deleted ${Fe.size} item${Fe.size>1?"s":""} successfully`}),ke(new Set),qe(!1),await rs()}catch(e){G({title:"Error",description:e instanceof Error?e.message:"Failed to delete items",variant:"destructive"})}finally{Ie(!1)}}else G({title:"No items selected",description:"Please select items to delete",variant:"destructive"})},disabled:Ae,className:"gap-2",children:Ae?e.jsxs(e.Fragment,{children:[e.jsx(ne.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:e.jsx(B,{className:"w-4 h-4"})}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-4 h-4"}),"Delete ",Fe.size," Item",1!==Fe.size?"s":""]})})]})]})})]})]})};export{de as default};
