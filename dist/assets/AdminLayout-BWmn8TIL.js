import{j as e}from"./ui-BFkRrjhf.js";import{u as s,h as a,r as t,L as n}from"./vendor-ClsjX3Mm.js";import{u as i,a as r,m as l,i as o,L as c,B as d}from"./index-CgruMJ9X.js";import{S as m}from"./scroll-area-DkFg0wM_.js";import{c as h,X as x,aL as u,U as f,B as p,h as g,a8 as j,aJ as b,v,a0 as N,ai as y,W as w,D as k,aM as C,A as z,am as L}from"./icons-Udnp6KR8.js";const M=({children:M})=>{const A=s(),S=a(),{toast:$}=i(),{refreshUser:D}=r(),[P,R]=t.useState(null),[U,q]=t.useState(!0),[B,E]=t.useState(!1),[Q,W]=t.useState(!1),[Y,F]=t.useState(!1);t.useEffect(()=>{J()},[]);const J=async()=>{try{const e=l();if(!e)return $({title:"Authentication Required",description:"Please log in to access the admin panel.",variant:"destructive"}),void S("/admin-auth");if(!("admin"===e.userType))return $({title:"Access Denied",description:"You don't have admin privileges.",variant:"destructive"}),o(),D(),void S("/admin-auth");R(!0)}catch(e){S("/admin-auth")}finally{q(!1)}};if(U)return e.jsx(c,{message:"Verifying admin access..."});if(!P)return null;const T=[{icon:u,label:"Dashboard",path:"/admin",exact:!0},{icon:f,label:"User Management",path:"/admin/users"},{icon:p,label:"Content Management",path:"/admin/content"},{icon:g,label:"Lessons & Quizzes",path:"/admin/lessons"},{icon:j,label:"Notifications",path:"/admin/notifications"},{icon:b,label:"Referral Management",path:"/admin/referrals"},{icon:v,label:"Analytics",path:"/admin/analytics"},{icon:N,label:"Reports",path:"/admin/reports"},{icon:y,label:"Settings",path:"/admin/settings"}],V=(e,s)=>s?A.pathname===e:A.pathname.startsWith(e);return e.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-background to-muted",children:[Q&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>W(!1)}),e.jsxs("aside",{className:`\n        ${B?"w-20":"w-64"} \n        bg-card border-r border-border flex flex-col transition-all duration-300\n        fixed lg:relative h-full z-50\n        ${Q?"translate-x-0":"-translate-x-full lg:translate-x-0"}\n      `,children:[e.jsx("div",{className:"p-6 border-b border-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 "+(B?"justify-center":""),children:[e.jsx("img",{src:"/assets/icons/mindsta2.png",alt:"Mindsta Logo",className:"w-10 h-10 object-contain"}),!B&&e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-foreground",children:"Mindsta"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Admin Panel"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>E(!B),className:"h-8 w-8 hidden lg:flex",children:e.jsx(h,{className:"w-4 h-4"})}),e.jsx(d,{variant:"ghost",size:"icon",className:"lg:hidden",onClick:()=>W(!1),children:e.jsx(x,{className:"w-5 h-5"})})]})]})}),e.jsx(m,{className:"flex-1 py-4",children:e.jsx("nav",{className:"space-y-1 px-3",children:T.map(s=>{const a=s.icon,t=V(s.path,s.exact);if("/admin/content"===s.path){const t=V(s.path);return e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("button",{onClick:()=>{B?(S(s.path),W(!1)):F(!Y)},className:`\n                          flex items-center ${B?"justify-center":"justify-between"} px-3 py-2 rounded-lg text-sm font-medium transition-all w-full\n                          ${t?"bg-primary text-primary-foreground shadow-sm":"text-muted-foreground hover:bg-muted hover:text-foreground"}\n                        `,title:B?s.label:void 0,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(a,{className:"w-5 h-5 flex-shrink-0"}),!B&&e.jsx("span",{children:s.label})]}),!B&&(Y?e.jsx(w,{className:"w-4 h-4 flex-shrink-0"}):e.jsx(k,{className:"w-4 h-4 flex-shrink-0"}))]}),!B&&Y&&e.jsxs("div",{className:"ml-8 mt-1 space-y-1",children:[e.jsxs(n,{to:"/admin/content?create=lesson",onClick:()=>W(!1),className:"flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground transition-all",children:[e.jsx(C,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:"Create Lesson"})]}),e.jsxs(n,{to:"/admin/content?create=quiz",onClick:()=>W(!1),className:"flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground transition-all",children:[e.jsx(z,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:"Create Quiz"})]})]})]})},s.path)}return e.jsxs(n,{to:s.path,onClick:()=>W(!1),className:`\n                    flex items-center ${B?"justify-center":"gap-3"} px-3 py-2 rounded-lg text-sm font-medium transition-all\n                    ${t?"bg-primary text-primary-foreground shadow-sm":"text-muted-foreground hover:bg-muted hover:text-foreground"}\n                  `,title:B?s.label:void 0,children:[e.jsx(a,{className:"w-5 h-5 flex-shrink-0"}),!B&&e.jsx("span",{children:s.label})]},s.path)})})}),e.jsx("div",{className:"p-4 border-t border-border",children:e.jsxs(d,{variant:"outline",className:"w-full "+(B?"px-2":"gap-2"),onClick:async()=>{try{o(),D(),S("/admin-auth"),$({title:"Logged out successfully",description:"You have been logged out of the admin panel."})}catch(e){$({title:"Error",description:"Failed to log out. Please try again.",variant:"destructive"})}},children:[e.jsx(L,{className:"w-4 h-4 flex-shrink-0"}),!B&&e.jsx("span",{children:"Logout"})]})})]}),e.jsxs("main",{className:"flex-1 overflow-auto",children:[e.jsxs("div",{className:"lg:hidden sticky top-0 z-30 bg-card border-b border-border p-4 flex items-center justify-between",children:[e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>W(!0),children:e.jsx(h,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:"/assets/icons/mindsta2.png",alt:"Mindsta Logo",className:"w-6 h-6 object-contain"}),e.jsx("span",{className:"font-bold",children:"Mindsta Admin"})]}),e.jsx("div",{className:"w-10"})," "]}),e.jsx("div",{className:"container mx-auto p-4 sm:p-6",children:M})]})]})};export{M as A};
